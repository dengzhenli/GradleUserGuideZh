

[ Gradle ](https://docs.gradle.org "Gradle Docs")

User Manual

  * Community Open Community Menu

[ Community Home ](https://gradle.org/)

[ Community Forums ](https://discuss.gradle.org/)

[ Community Plugins ](https://plugins.gradle.org)

  * [Training](https://gradle.com/training/)
  * News Open Community Menu

[ Newsletter ](https://newsletter.gradle.com)

[ Blog ](https://blog.gradle.org)

[ Twitter ](https://twitter.com/gradle)

  * [Enterprise](https://gradle.com)
  * [github](https://github.com/gradle/gradle "Gradle on GitHub")

  * [Docs Home](../userguide/userguide.html)
  * [Samples](../samples/index.html)
  * [Release Notes](../release-notes.html)
  * Gradle DSLs and API
    * [Javadoc](../javadoc/index.html?overview-summary.html)
    * [Groovy DSL Reference](../dsl/index.html)
    * [Groovy DSL Primer](../userguide/groovy_build_script_primer.html)
    * [Kotlin DSL API](https://gradle.github.io/kotlin-dsl-docs/api/)
    * [Kotlin DSL Primer](../userguide/kotlin_dsl.html)
    * [Groovy to Kotlin DSL Migration](../userguide/migrating_from_groovy_to_kotlin_dsl.html)

### User Manual

[ PDF ](../userguide/userguide.pdf)

  * [What is Gradle?](../userguide/what_is_gradle.html)
  * [Getting Started](../userguide/getting_started.html)
  * [Installing Gradle](../userguide/installation.html)
  * Upgrading Gradle...
    * [version 6.X to latest](../userguide/upgrading_version_6.html)
    * [version 5.X to 6.0](../userguide/upgrading_version_5.html)
    * [version 4.X to 5.0](../userguide/upgrading_version_4.html)
    * [Gradle's Feature Lifecycle](../userguide/feature_lifecycle.html)
  * Migrating to Gradle...
    * [from Maven](../userguide/migrating_from_maven.html)
    * [from Ant](../userguide/migrating_from_ant.html)
  * [Compatibility Notes](../userguide/compatibility.html)
  * [Troubleshooting Builds](../userguide/troubleshooting.html)

### Running Gradle Builds

  * Customizing Execution
    * [Configuring the Build Environment](../userguide/build_environment.html)
    * [Configuring the Gradle Daemon](../userguide/gradle_daemon.html)
    * [Using Initialization Scripts](../userguide/init_scripts.html)
  * [Executing Multi-Project Builds](../userguide/intro_multi_project_builds.html)
  * [Inspecting Gradle Builds](https://scans.gradle.com/)
  * Using the Build Cache
    * [Enabling and Configuring](../userguide/build_cache.html)
    * [Why use the Build Cache?](../userguide/build_cache_use_cases.html)
    * [Understanding the Impact](../userguide/build_cache_performance.html)
    * [Learning Basic Concepts](../userguide/build_cache_concepts.html)
    * [Caching Java Project](../userguide/caching_java_projects.html)
    * [Caching Android Project](../userguide/caching_android_projects.html)
    * [Debugging Caching Issues](../userguide/build_cache_debugging.html)
    * [Troubleshooting](../userguide/common_caching_problems.html)
  * Optimizing Build Times
    * [Improving Performance of Gradle Builds](../userguide/performance.html)
    * [Using the Configuration Cache](../userguide/configuration_cache.html)

### Authoring Gradle Builds

  * Learning the Basics
    * [Writing Build Scripts](../userguide/tutorial_using_tasks.html)
    * [Working with Tasks](../userguide/more_about_tasks.html)
    * [Learning More About Build Scripts](../userguide/writing_build_scripts.html)
    * [Working with Files](../userguide/working_with_files.html)
    * [Using Gradle Plugins](../userguide/plugins.html)
    * [Understanding the Build Lifecycle](../userguide/build_lifecycle.html)
    * [Working with Logging](../userguide/logging.html)
    * [Avoiding Traps](../userguide/potential_traps.html)
  * Structuring Individual Builds
    * [Creating a Basic Multi-Project Build](../userguide/multi_project_builds.html)
    * [Declaring Dependencies between Subprojects](../userguide/declaring_dependencies_between_subprojects.html)
    * [Sharing Build Logic between Subprojects](../userguide/sharing_build_logic_between_subprojects.html)
    * [Fine Tuning the Project Layout](../userguide/fine_tuning_project_layout.html)
    * [Understanding Configuration and Execution](../userguide/multi_project_configuration_and_execution.html)
  * Structuring Software Products
    * [Structuring large Projects](../userguide/structuring_software_products.html)
    * [Tweaking Project Structure](../userguide/structuring_software_products_details.html)
    * [Composing Builds](../userguide/composite_builds.html)
  * Authoring Sustainable Builds
    * [Organizing Build Logic](../userguide/organizing_gradle_projects.html)
    * [Following Best Practices](../userguide/authoring_maintainable_build_scripts.html)
  * Advanced Techniques
    * [Testing a Build with TestKit](../userguide/test_kit.html)
    * [Using Ant from Gradle](../userguide/ant.html)

### Authoring JVM Builds

  * [Building Java & JVM projects](../userguide/building_java_projects.html)
  * [Testing Java & JVM projects](../userguide/java_testing.html)
  * [Toolchains for Java projects](../userguide/toolchains.html)
  * [Managing Dependencies](../userguide/dependency_management_for_java_projects.html)
  * JVM Plugins
    * [Java Library Plugin](../userguide/java_library_plugin.html)
    * [Java Application Plugin](../userguide/application_plugin.html)
    * [Java Platform Plugin](../userguide/java_platform_plugin.html)
    * [Groovy Plugin](../userguide/groovy_plugin.html)
    * [Scala Plugin](../userguide/scala_plugin.html)

### Authoring C++/Swift Builds

  * [Building C++ projects](../userguide/building_cpp_projects.html)
  * [Testing C++ projects](../userguide/cpp_testing.html)
  * [Building Swift projects](../userguide/building_swift_projects.html)
  * [Testing Swift projects](../userguide/swift_testing.html)

### Working with Dependencies

  * Learning the Basics
    * [What is Dependency Management?](../userguide/core_dependency_management.html)
    * [Declaring Repositories](../userguide/declaring_repositories.html)
    * [Declaring Dependencies](../userguide/declaring_dependencies.html)
    * [Understanding Library and Application Differences](../userguide/library_vs_application.html)
    * [Viewing and Debugging Dependencies](../userguide/viewing_debugging_dependencies.html)
    * [Understanding Resolution](../userguide/dependency_resolution.html)
    * [Verifying dependencies](../userguide/dependency_verification.html)
  * Declaring Versions
    * [Declaring Versions and Ranges](../userguide/single_versions.html)
    * [Declaring Rich Versions](../userguide/rich_versions.html)
    * [Handling Changing Versions](../userguide/dynamic_versions.html)
    * [Locking Versions](../userguide/dependency_locking.html)
  * Controlling Transitives
    * [Upgrading Versions](../userguide/dependency_constraints.html)
    * [Downgrading and Excluding](../userguide/dependency_downgrade_and_exclude.html)
    * [Sharing Versions](../userguide/platforms.html)
    * [Aligning Dependencies](../userguide/dependency_version_alignment.html)
    * [Handling Mutually Exclusive Dependencies](../userguide/dependency_capability_conflict.html)
    * [Fixing Metadata](../userguide/component_metadata_rules.html)
    * [Customizing Resolution](../userguide/resolution_rules.html)
    * [Preventing accidental upgrades](../userguide/resolution_strategy_tuning.html)
  * Producing and Consuming Variants of Libraries
    * [Declaring Capabilities of a Library](../userguide/component_capabilities.html)
    * [Modeling Feature Variants and Optional Dependencies](../userguide/feature_variants.html)
    * [Understanding Variant Selection](../userguide/variant_model.html)
    * [Declaring Variant Attributes](../userguide/variant_attributes.html)
    * [Sharing Outputs of Projects](../userguide/cross_project_publications.html)
    * [Transforming Artifacts](../userguide/artifact_transforms.html)
  * Publishing Libraries
    * [Setting up Publishing](../userguide/publishing_setup.html)
    * [Understanding Gradle Module Metadata](../userguide/publishing_gradle_module_metadata.html)
    * [Signing Artifacts](../userguide/publishing_signing.html)
    * [Customizing Publishing](../userguide/publishing_customization.html)
    * [Maven Publish Plugin](../userguide/publishing_maven.html)
    * [Ivy Publish Plugin](../userguide/publishing_ivy.html)
  * [Terminology](../userguide/dependency_management_terminology.html)

### Extending Gradle

  * Developing Gradle Plugins
    * [Starting Plugin Development](../userguide/custom_plugins.html)
    * [Designing Plugins](../userguide/designing_gradle_plugins.html)
    * [Implementing Plugins](../userguide/implementing_gradle_plugins.html)
    * [Testing Plugins](../userguide/testing_gradle_plugins.html)
    * [Publishing Plugins](../userguide/publishing_gradle_plugins.html)
  * Developing Gradle Tasks
    * [Writing Gradle Task Types](../userguide/custom_tasks.html)
    * [Configuring Tasks Lazily](../userguide/lazy_configuration.html)
    * [Avoiding Unnecessary Task Configuration](../userguide/task_configuration_avoidance.html)
    * [Developing Parallel Tasks](../userguide/worker_api.html)
  * [Writing Custom Gradle Types](../userguide/custom_gradle_types.html)

### Reference

  * [Core Plugins](../userguide/plugin_reference.html)
  * [Command-Line Interface](../userguide/command_line_interface.html)
  * Gradle & Third-party Tools
    * [Third-party Tools](../userguide/third_party_integration.html)
    * [Jenkins](../userguide/jenkins.html)
    * [TeamCity](../userguide/teamcity.html)
    * [Travis CI](../userguide/travis-ci.html)
  * [](../userguide/third_party_integration.html)
  * [The Gradle Wrapper](../userguide/gradle_wrapper.html)
  * [Gradle-managed Directories](../userguide/directory_layout.html)

# Configuration time and execution time

version 6.9-20201126230040+0000

Contents

  * Parallel project execution
  * Decoupled Projects
  * Configuration on demand

[Build phases](build_lifecycle.html#sec:build_phases) describes the phases of
every Gradle build. Let's zoom into the configuration and execution phases of
a multi-project build. Configuration here means evaluating the build script
file of a project, which includes downloading all plugins and build script
dependencies. By default, the configuration of all projects happens before any
task is executed. This means that when a single task, from a single project is
requested, _all_ projects of a multi-project build are configured first. The
reason every project needs to be configured is to support the flexibility of
accessing and changing any part of the Gradle project model.

## Parallel project execution

With more and more CPU cores available on developer desktops and CI servers,
it is important that Gradle is able to fully utilise these processing
resources. More specifically, parallel execution attempts to:

  * Reduce total build time for a multi-project build where execution is IO bound or otherwise does not consume all available CPU resources.

  * Provide faster feedback for execution of small projects without awaiting completion of other projects.

Although Gradle already offers parallel test execution via
[Test.setMaxParallelForks(int)](../javadoc/org/gradle/api/tasks/testing/Test.html#setMaxParallelForks-
int-) the feature described in this section is parallel execution at a project
level.

Parallel project execution allows the separate projects in a decoupled multi-
project build to be executed in parallel (see also Decoupled projects). While
parallel execution does not strictly require decoupling at configuration time,
the long-term goal is to provide a powerful set of features that will be
available for fully decoupled projects. Such features include:

  * Configuration on-demand.

  * Configuration of projects in parallel.

  * Re-use of configuration for unchanged projects.

  * Project-level up-to-date checks.

  * Using pre-built artifacts in the place of building dependent projects.

How does parallel execution work? First, you need to tell Gradle to use
parallel mode. You can use the [`--parallel` command line
argument](command_line_interface.html#sec:command_line_performance) or
configure your build environment ([Gradle
properties](build_environment.html#sec:gradle_configuration_properties)).
Unless you provide a specific number of parallel threads, Gradle attempts to
choose the right number based on available CPU cores. Every parallel worker
exclusively owns a given project while executing a task. Task dependencies are
fully supported and parallel workers will start executing upstream tasks
first. Bear in mind that the alphabetical ordering of decoupled tasks, as can
be seen during sequential execution, is not guaranteed in parallel mode. In
other words, in parallel mode tasks will run as soon as their dependencies
complete _and a task worker is available to run them_ , which may be earlier
than they would start during a sequential build. You should make sure that
task dependencies and task inputs/outputs are declared correctly to avoid
ordering issues.

## Decoupled Projects

Gradle allows any project to access any other project during both the
configuration and execution phases. While this provides a great deal of power
and flexibility to the build author, it also limits the flexibility that
Gradle has when building those projects. For instance, this effectively
prevents Gradle from correctly building multiple projects in parallel,
configuring only a subset of projects, or from substituting a pre-built
artifact in place of a project dependency.

Two projects are said to be _decoupled_ if they do not directly access each
other's project model. Decoupled projects may only interact in terms of
declared dependencies: [project
dependencies](declaring_dependencies.html#sub:project_dependencies) and/or
[task dependencies](tutorial_using_tasks.html#sec:task_dependencies). Any
other form of project interaction (i.e. by modifying another project object or
by reading a value from another project object) causes the projects to be
coupled. The consequence of coupling during the configuration phase is that if
gradle is invoked with the 'configuration on demand' option, the result of the
build can be flawed in several ways. The consequence of coupling during
execution phase is that if gradle is invoked with the parallel option, one
project task runs too late to influence a task of a project building in
parallel. Gradle does not attempt to detect coupling and warn the user, as
there are too many possibilities to introduce coupling.

A very common way for projects to be coupled is by using [configuration
injection](sharing_build_logic_between_subprojects.html#sec:convention_plugins_vs_cross_configuration).
It may not be immediately apparent, but using key Gradle features like the
`allprojects` and `subprojects` keywords automatically cause your projects to
be coupled. This is because these keywords are used in a `build.gradle` file,
which defines a project. Often this is a “root project” that does nothing more
than define common configuration, but as far as Gradle is concerned this root
project is still a fully-fledged project, and by using `allprojects` that
project is effectively coupled to all other projects. Coupling of the root
project to subprojects does not impact 'configuration on demand', but using
the `allprojects` and `subprojects` in any subproject's `build.gradle` file
will have an impact.

This means that using any form of shared build script logic or configuration
injection (`allprojects`, `subprojects`, etc.) will cause your projects to be
coupled. As we extend the concept of project decoupling and provide features
that take advantage of decoupled projects, we will also introduce new features
to help you to solve common use cases (like configuration injection) without
causing your projects to be coupled.

In order to make good use of cross project configuration without running into
issues for parallel and 'configuration on demand' options, follow these
recommendations:

  * Avoid a subproject's build script referencing other subprojects; preferring cross configuration from the root project.

  * Avoid changing the configuration of other projects at execution time.

## Configuration on demand

The _Configuration injection_ feature and access to the complete project model
are possible because every project is configured before the execution phase.
Yet, this approach may not be the most efficient in a very large multi-project
build. There are Gradle builds with a hierarchy of hundreds of subprojects.
The configuration time of huge multi-project builds may become noticeable.

Configuration on demand attempts to configure only projects that are relevant
for requested tasks, i.e. it only executes the build script file of projects
that are participating in the build. This way, the configuration time of a
large multi-project build can be reduced.

The configuration on demand feature is incubating, so not every build is
guaranteed to work correctly. The feature should work very well for multi-
project builds that have decoupled projects. In “configuration on demand”
mode, projects are configured as follows:

  * The root project is always configured.

  * The project in the directory where the build is executed is also configured, but only when Gradle is executed without any tasks. This way the default tasks behave correctly when projects are configured on demand.

  * The standard project dependencies are supported and makes relevant projects configured. If project A has a compile dependency on project B then building A causes configuration of both projects.

  * The task dependencies declared via task path are supported and cause relevant projects to be configured. Example: `someTask.dependsOn(":some-other-project:someOtherTask")`

  * A task requested via task path from the command line (or Tooling API) causes the relevant project to be configured. For example, building 'project-a:project-b:someTask' causes configuration of project-b.

To configure on demand with every build run see [Gradle
properties](build_environment.html#sec:gradle_configuration_properties). To
configure on demand just for a given build, see [command-line performance-
oriented options](command_line_interface.html#sec:command_line_performance).

**Docs**

  * [User Manual](/userguide/userguide.html)
  * [DSL Reference](/dsl/)
  * [Release Notes](/release-notes.html)
  * [Javadoc](/javadoc/)

**News**

  * [Blog](https://blog.gradle.org/)
  * [Newsletter](https://newsletter.gradle.com/)
  * [Twitter](https://twitter.com/gradle)
  * [Status Page](https://status.gradle.com/)

**Products**

  * [Build Scans](https://gradle.com/build-scans/)
  * [Build Cache](https://gradle.com/build-cache/)
  * [Enterprise Docs](https://gradle.com/enterprise/resources/)

**Get Help**

  * [Forums](https://discuss.gradle.org/c/help-discuss)
  * [GitHub](https://github.com/gradle/)
  * [Training](https://gradle.com/training/)
  * [Services](https://gradle.org/services/)

##### Stay `UP-TO-DATE` on new features and news

By entering your email, you agree to our
[Terms](https://gradle.com/legal/terms-of-service/) and [Privacy
Policy](https://gradle.com/legal/privacy/), including receipt of emails. You
can unsubscribe at any time.

Subscribe

© [Gradle Inc.](https://gradle.com) 2020 All rights reserved.

[ gradle ](/)

[Careers](https://gradle.com/careers/) |
[Privacy](https://gradle.com/legal/privacy/) | [Terms of
Service](https://gradle.com/legal/terms-of-service/) |
[Contact](https://gradle.org/contact/)

