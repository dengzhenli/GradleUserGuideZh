

[ Gradle ](https://docs.gradle.org/ "Gradle Docs")

用户手册

  * 社区 Open Community Menu

[ 社区之家 ](https://gradle.org/)

[ 社区论坛 ](https://discuss.gradle.org/)

[ 社区插件 ](https://plugins.gradle.org/)

  * [训练](https://gradle.com/training/)
  * 新闻 Open Community Menu

[ 通讯 ](https://newsletter.gradle.com/)

[ 博客 ](https://blog.gradle.org/)

[ 推特 ](https://twitter.com/gradle)

  * [企业](https://gradle.com/)
  * [github](https://github.com/gradle/gradle "GitHub上的Gradle")

  * [文件首页](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/userguide.html)
  * [样品](file:///Users/dxs/temp/gradle-6.7.1/docs/samples/index.html)
  * [发行说明](file:///Users/dxs/temp/gradle-6.7.1/docs/release-notes.html)
  * [Gradle API](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#gradle-api)
    * [Java文档](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/index.html?overview-summary.html)
    * [Groovy DSL参考](file:///Users/dxs/temp/gradle-6.7.1/docs/dsl/index.html)
    * [Groovy DSL入门](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/groovy_build_script_primer.html)
    * [Kotlin DSL API](https://gradle.github.io/kotlin-dsl-docs/api/)
    * [Kotlin DSL入门](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/kotlin_dsl.html)

### 用户手册

[ PDF格式 ](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/userguide.pdf)

  * [什么是Gradle？](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/what_is_gradle.html)
  * [入门](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/getting_started.html)
  * [安装Gradle](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/installation.html)
  * [升级Gradle ...](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#upgrading-gradle)
    * [版本6.X到最新](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/upgrading_version_6.html)
    * [版本5.X到6.0](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/upgrading_version_5.html)
    * [版本4.X到5.0](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/upgrading_version_4.html)
    * [Gradle的功能生命周期](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/feature_lifecycle.html)
  * [迁移至Gradle ...](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#migrating-to-gradle)
    * [从Maven](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/migrating_from_maven.html)
    * [来自蚂蚁](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/migrating_from_ant.html)
  * [相容性说明](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/compatibility.html)
  * [对构建进行故障排除](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/troubleshooting.html)

### 运行Gradle构建

  * [自定义执行](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#customizing-execution)
    * [配置构建环境](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/build_environment.html)
    * [Configuring the Gradle Daemon](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/gradle_daemon.html)
    * [Using Initialization Scripts](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/init_scripts.html)
  * [执行多项目构建](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/intro_multi_project_builds.html)
  * [检查Gradle构建](https://scans.gradle.com/)
  * [优化构建时间](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#optimizing-build-performance)
    * [Build Performance Guide](https://guides.gradle.org/performance/)
    * [Enabling and Configuring the Build Cache](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/build_cache.html)
    * [Using the Configuration Cache](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/configuration_cache.html)

### 编写Gradle构建

  * [学习基础](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#learning-the-basics)
    * [Introducing the Basics of Build Scripts](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/tutorial_using_tasks.html)
    * [Working with Tasks](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/more_about_tasks.html)
    * [Learning More About Build Scripts](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/writing_build_scripts.html)
    * [Working with Files](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/working_with_files.html)
    * [Using Gradle Plugins](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/plugins.html)
    * [Understanding the Build Lifecycle](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/build_lifecycle.html)
    * [Working with Logging](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/logging.html)
    * [Avoiding Traps](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/potential_traps.html)
  * [创作多项目构建](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#authoring-multi-project-builds)
    * [Creating a Basic Multi-Project Build](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/multi_project_builds.html)
    * [Declaring Dependencies between Subprojects](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/declaring_dependencies_between_subprojects.html)
    * [Sharing Build Logic between Subprojects](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/sharing_build_logic_between_subprojects.html)
    * [Fine Tuning the Project Layout](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/fine_tuning_project_layout.html)
    * [Understanding Configuration and Execution](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/multi_project_configuration_and_execution.html)
  * [创作可持续建筑](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#authoring-sustainable-builds)
    * [Organizing Build Logic](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/organizing_gradle_projects.html)
    * [Following Best Practices](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/authoring_maintainable_build_scripts.html)
  * [先进技术](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#advanced-techniques)
    * [Developing Parallel Tasks](https://guides.gradle.org/using-the-worker-api/)
    * [Testing a Build with TestKit](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/test_kit.html)
    * [Using Ant from Gradle](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/ant.html)

### 编写JVM构建

  * [构建Java和JVM项目](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/building_java_projects.html)
  * [测试Java和JVM项目](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/java_testing.html)
  * [Java项目的工具链](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html)
  * [管理依赖关系](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_management_for_java_projects.html)
  * [JVM插件](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#jvm-plugins)
    * [Java Library Plugin](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/java_library_plugin.html)
    * [Java Application Plugin](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/application_plugin.html)
    * [Java Platform Plugin](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/java_platform_plugin.html)
    * [Groovy Plugin](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/groovy_plugin.html)
    * [Scala Plugin](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/scala_plugin.html)

### 编写C ++ / Swift构建

  * [构建C ++项目](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/building_cpp_projects.html)
  * [测试C ++项目](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/cpp_testing.html)
  * [建立Swift项目](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/building_swift_projects.html)
  * [测试Swift项目](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/swift_testing.html)

### 使用依赖项

  * [学习基础](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#learning-the-basics-dependency-management)
    * [What is Dependency Management?](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/core_dependency_management.html)
    * [Declaring Repositories](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/declaring_repositories.html)
    * [Declaring Dependencies](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/declaring_dependencies.html)
    * [Understanding Library and Application Differences](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/library_vs_application.html)
    * [Viewing and Debugging Dependencies](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/viewing_debugging_dependencies.html)
    * [Understanding Resolution](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_resolution.html)
    * [Verifying dependencies](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_verification.html)
  * [声明版本](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#declaring-dependency-versions)
    * [Declaring Versions and Ranges](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/single_versions.html)
    * [Declaring Rich Versions](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/rich_versions.html)
    * [Handling Changing Versions](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dynamic_versions.html)
    * [Locking Versions](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_locking.html)
  * [控制翻译](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#controlling-transitive-dependencies)
    * [Upgrading Versions](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_constraints.html)
    * [Downgrading and Excluding](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_downgrade_and_exclude.html)
    * [Sharing Versions](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/platforms.html)
    * [Aligning Dependencies](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_version_alignment.html)
    * [Handling Mutually Exclusive Dependencies](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_capability_conflict.html)
    * [Fixing Metadata](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/component_metadata_rules.html)
    * [Customizing Resolution](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/resolution_rules.html)
    * [Preventing accidental upgrades](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/resolution_strategy_tuning.html)
  * [图书馆的生产和消费形式](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#modeling-features)
    * [Declaring Capabilities of a Library](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/component_capabilities.html)
    * [Modeling Feature Variants and Optional Dependencies](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/feature_variants.html)
    * [Understanding Variant Selection](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/variant_model.html)
    * [Declaring Variant Attributes](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/variant_attributes.html)
    * [Sharing Outputs of Projects](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/cross_project_publications.html)
    * [Transforming Artifacts](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/artifact_transforms.html)
  * [在多仓库环境中工作](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#multi-repo)
    * [Composing Builds](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/composite_builds.html)
  * [出版图书馆](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#publishing)
    * [Setting up Publishing](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_setup.html)
    * [Understanding Gradle Module Metadata](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_gradle_module_metadata.html)
    * [Signing Artifacts](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_signing.html)
    * [Customizing Publishing](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_customization.html)
    * [Maven Publish Plugin](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_maven.html)
    * [Ivy Publish Plugin](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html)
  * [术语](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_management_terminology.html)

### 扩展摇篮

  * [插件开发教程](https://gradle.org/guides/?q=Plugin%20Development)
  * [编写Gradle任务类型](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/custom_tasks.html)
  * [编写Gradle插件](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/custom_plugins.html)
  * [编写自定义Gradle类型](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/custom_gradle_types.html)
  * [延迟配置任务](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/lazy_configuration.html)
  * [使用避免任务配置](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html)

### 参考

  * [核心插件](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/plugin_reference.html)
  * [命令行界面](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/command_line_interface.html)
  * [Gradle和第三方工具](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/third_party_integration.html)
  * [摇篮包装](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/gradle_wrapper.html)
  * [Gradle管理的目录](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/directory_layout.html)

# JVM项目的工具链

version 6.7.1

内容

  * [消费工具链](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#sec:consuming)
  * [为个别任务指定自定义工具链](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#specify_custom_toolchains_for_individual_tasks)
  * [自动检测已安装的工具链](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#sec:auto_detection)
  * [自动配置](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#sec:provisioning)
  * [自定义工具链位置](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#sec:custom_loc)
  * [插件作者的工具链](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#sec:plugins)

默认情况下，Gradle使用相同的Java版本来运行Gradle本身和构建JVM项目。

这并不总是可取的。在不同的开发人员机器和CI服务器上使用不同的Java版本构建项目可能会导致意外问题。此外，您可能想使用不支持运行Gradle的Java版本来构建项目。

Java工具链（从现在开始简称为工具链）是一组工具，通常取自本地JRE /
JDK安装，用于配置构建的不同方面。编译任务可以`javac`用作其编译器，而test和exec任务可以使用该`java`命令，同时`javadoc`将用于生成文档。

##
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#sec:consuming)[消费工具链](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#sec:consuming)

构建可以通过声明所需的Java语言版本来全局定义其目标工具链：

`Groovy``Kotlin`

buildSrc / src / main / groovy / myproject.java-conventions.gradle

    
    
    java {
        toolchain {
            languageVersion = JavaLanguageVersion.of(14)
        }
    }

buildSrc/src/main/kotlin/myproject.java-conventions.gradle.kts

    
    
    java {
        toolchain {
            languageVersion.set(JavaLanguageVersion.of(14))
        }
    }

现在，执行构建（例如使用`gradle check`）将为您和其他运行构建的人处理几件事

  1. 设置所有编译，测试和javadoc任务以使用已定义的工具链，该工具链可能与Gradle本身使用的工具链不同

  2. Gradle检测[本地安装的JVM](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#sec:auto_detection)

  3. Gradle选择符合构建要求的JRE / JDK（在这种情况下，JVM支持Java 14）

  4. 如果找不到匹配的JVM，它将自动从[AdoptOpenJDK](https://adoptopenjdk.net/)下载匹配的JDK。[](https://adoptopenjdk.net/)

__ |

工具链支持仅在Java插件及其定义的任务中可用。Groovy和Scala插件的支持将在以后发布。该支持将涵盖这些插件添加的特定编译和文档编制任务。但是，由于任务确实支持工具链，因此
_运行测试_ 可以利用工具链的支持`Test`。  
  
---|---  
  
##
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#specify_custom_toolchains_for_individual_tasks)[为个别任务指定自定义工具链](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#specify_custom_toolchains_for_individual_tasks)

如果要调整用于特定任务的工具链，可以指定任务使用的确切工具。例如，该`Test`任务公开了一个`JavaLauncher`属性，该属性定义了用于启动测试的java可执行文件。

在下面的示例中，我们将默认工具链配置为使用JDK8进行编译和测试。此外，我们引入了一个新`Test`任务，它将使用JDK 14运行单元测试。

`Groovy``Kotlin`

list / build.gradle

    
    
    tasks.withType(JavaCompile).configureEach {
        javaCompiler = javaToolchains.compilerFor {
            languageVersion = JavaLanguageVersion.of(8)
        }
    }
    test {
        javaLauncher = javaToolchains.launcherFor {
            languageVersion = JavaLanguageVersion.of(14)
        }
    }

list/build.gradle.kts

    
    
    tasks.withType<JavaCompile>().configureEach {
        javaCompiler.set(javaToolchains.compilerFor {
            languageVersion.set(JavaLanguageVersion.of(8))
        })
    }
    
    tasks.withType<Test>().configureEach {
        javaLauncher.set(javaToolchains.launcherFor {
            languageVersion.set(JavaLanguageVersion.of(14))
        })
    }

根据任务的不同，一个JRE可能就足够了，而对于其他任务（例如，编译），则需要一个JDK。默认情况下，Gradle比JRE更喜欢安装的JDK。

可以从[`javaToolchains`](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/jvm/toolchain/JavaToolchainService.html)扩展中获得工具链工具提供者。

提供三种工具：

  * A`JavaCompiler`是`JavaCompile`任务使用的工具

  * A`JavaLauncher`是`JavaExec`或`Test`任务使用的工具

  * A`JavadocTool`是`Javadoc`任务使用的工具

###
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#integration_with_tasks_relying_on_a_java_executable_or_java_home)[与依赖Java可执行文件或Java主目录的任务集成](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#integration_with_tasks_relying_on_a_java_executable_or_java_home)

可以使用Java可执行文件的路径或Java主目录配置的任何任务都可以从工具链中受益。

尽管您将无法直接连接工具链工具，但是它们都具有元数据，可以访问其完整路径或它们所属的Java安装路径。

例如，您可以按以下方式为Kotlin编译任务配置可执行文件：

`Groovy``Kotlin`

build.gradle

    
    
    def compiler = javaToolchains.compilerFor {
        languageVersion = JavaLanguageVersion.of(11)
    }
    
    tasks.withType(KotlinJvmCompile).configureEach {
        kotlinOptions.jdkHome = compiler.get().metadata.installationPath.asFile.absolutePath
    }

build.gradle.kts

    
    
    val compiler = javaToolchains.compilerFor {
        languageVersion.set(JavaLanguageVersion.of(11))
    }
    
    tasks.withType<KotlinJvmCompile>().configureEach {
        kotlinOptions.jdkHome = compiler.get().metadata.installationPath.asFile.absolutePath
    }

同样，这样做`compiler.get().executablePath`会为您`javac`提供给定工具链的完整路径。但是请注意，这可能会急切地实现（并提供）工具链。

##
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#sec:auto_detection)[自动检测已安装的工具链](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#sec:auto_detection)

默认情况下，Gradle自动检测本地JRE / JDK安装，因此用户不需要进一步的配置。以下是JVM自动检测支持的常见程序包管理器和位置的列表。

操作系统特定的位置：

  * 的Linux

  * 苹果系统

  * 视窗

支持的软件包管理器：

  * [音频文件](https://asdf-vm.com/#/)

  * [贾巴](https://github.com/shyiko/jabba)

  * [SDKMAN！](https://sdkman.io/)

###
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#sub:disable_auto_detect)[如何禁用自动检测](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#sub:disable_auto_detect)

为了禁用自动检测，可以使用`org.gradle.java.installations.auto-detect`Gradle属性：

  * 要么使用开始gradle `-Porg.gradle.java.installations.auto-detect=false`

  * 或放入`org.gradle.java.installations.auto-detect=false`您的`gradle.properties`文件中。

##
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#sec:provisioning)[自动配置](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#sec:provisioning)

如果Gradle找不到与构建要求匹配的本地可用工具链，它将自动尝试从AdoptOpenJDK下载它。默认情况下，它将请求与当前操作系统和体系结构匹配的HotSpot
JDK。预配JDK安装在[Gradle用户主目录中](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/directory_layout.html#dir:gradle_user_home)。

__ |

Gradle将仅下载GA发行版的JDK版本。不支持下载早期访问版本。  
  
---|---  
  
默认情况下，公共[AdoptOpenJDK
API](https://api.adoptopenjdk.net/)用于确定和下载匹配的JDK。如果您要使用与AdoptOpenJDK API
v3兼容的另一台服务器，则可以使Gradle使用其他主机。为此，您可以使用Gradle属性，如以下示例所示：

    
    
    org.gradle.jvm.toolchain.install.adoptopenjdk.baseUri = https：//api.company.net/

__ |

仅`https`接受像这样的安全协议。这是确保没有人可以篡改飞行中的下载所必需的。  
  
---|---  
  
###
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#sub:disable_auto_provision)[如何禁用自动配置](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#sub:disable_auto_provision)

为了禁用自动配置，可以使用`org.gradle.java.installations.auto-download`Gradle属性：

  * 要么使用开始gradle `-Porg.gradle.java.installations.auto-download=false`

  * 或把`org.gradle.java.installations.auto-download=false`成一个`gradle.properties`文件。

##
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#sec:custom_loc)[自定义工具链位置](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#sec:custom_loc)

如果自动检测本地工具链不足或被禁用，则可以通过其他方法让Gradle知道已安装的工具链。

如果您的设置已经提供了指向已安装的JVM的环境变量，则还可以让Gradle知道要考虑哪些环境变量。假设环境变量`JDK8`并`JRE14`指向有效的Java安装，以下内容指示Gradle在寻找匹配的工具链时解析这些环境变量并考虑这些安装。

    
    
    org.gradle.java.installations.fromEnv = JDK8，JRE14

另外，您可以使用该`org.gradle.java.installations.paths`属性提供以逗号分隔的特定安装路径的列表。例如，在您的代码中使用以下命令`gradle.properties`可使Gradle知道检测JVM时要查看的目录。Gradle会将这些目录视为可能的安装，但不会下降到任何嵌套目录中。

    
    
    org.gradle.java.installations.paths = / custom / path / jdk1.8，/ shared / jre11

##
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#sec:plugins)[插件作者的工具链](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html#sec:plugins)

需要JDK中的工具的自定义任务应将`Property<T>`带有所需工具的公开为通用类型。通过`JavaToolchainService`在插件或任务中注入，也可以通过`JavaToolchainSpec`从`java`项目扩展名中获取来在这些属性中连接约定。下面的示例展示了如何使用默认工具链作为约定，同时允许用户针对每个任务单独配置工具链。

`Groovy``Kotlin`

build.gradle

    
    
    import javax.inject.Inject;
    
    class CustomTaskUsingToolchains extends DefaultTask {
    
        @Input
        final Property<JavaLauncher> launcher = project.objects.property(JavaLauncher.class);
    
        @Inject
        CustomTaskUsingToolchains(ObjectFactory factory) {
            // Access the default toolchain
            def toolchain = project.getExtensions().getByType(JavaPluginExtension.class).toolchain
    
            // acquire a provider that returns the launcher for the toolchain
            JavaToolchainService service = project.getExtensions().getByType(JavaToolchainService.class);
            Provider<JavaLauncher> defaultLauncher = service.launcherFor(toolchain);
    
            // use it as our default for the property
            launcher.convention(defaultLauncher);
        }
    
        @TaskAction
        def showConfiguredToolchain() {
            println launcher.get().executablePath
            println launcher.get().metadata.installationPath
        }
    }
    
    plugins {
        id 'java'
    }
    
    java {
        toolchain {
            languageVersion = JavaLanguageVersion.of(8)
        }
    }
    
    task showDefaultToolchain(type: CustomTaskUsingToolchains)
    
    task showCustomToolchain(type: CustomTaskUsingToolchains) {
        launcher = javaToolchains.launcherFor {
            languageVersion = JavaLanguageVersion.of(14)
        }
    }

build.gradle.kts

    
    
    import javax.inject.Inject;
    
    open class CustomTaskUsingToolchains : DefaultTask {
    
        @get:Input
        val launcher: Property<JavaLauncher> = project.objects.property()
    
        @Inject
        constructor() {
            // Access the default toolchain
            val toolchain = project.extensions.getByType<JavaPluginExtension>().toolchain
    
            // acquire a provider that returns the launcher for the toolchain
            val service = project.extensions.getByType<JavaToolchainService>()
            val defaultLauncher = service.launcherFor(toolchain)
    
            // use it as our default for the property
            launcher.convention(defaultLauncher);
        }
    
        @TaskAction
        fun showConfiguredToolchain() {
            println(launcher.get().executablePath)
            println(launcher.get().metadata.installationPath)
        }
    }
    
    plugins {
        java
    }
    
    java {
        toolchain {
            languageVersion.set(JavaLanguageVersion.of(8))
        }
    }
    
    tasks.register<CustomTaskUsingToolchains>("showDefaultToolchain")
    
    tasks.register<CustomTaskUsingToolchains>("showCustomToolchain") {
        launcher.set(javaToolchains.launcherFor {
            languageVersion.set(JavaLanguageVersion.of(14))
        })
    }

**文件**

  * [用户手册](file:///userguide/userguide.html)
  * [DSL参考](file:///dsl/)
  * [发行说明](file:///release-notes.html)
  * [Java文档](file:///javadoc/)

**新闻**

  * [博客](https://blog.gradle.org/)
  * [通讯](https://newsletter.gradle.com/)
  * [推特](https://twitter.com/gradle)
  * [状态页](https://status.gradle.com/)

**产品展示**

  * [构建扫描](https://gradle.com/build-scans/)
  * [构建缓存](https://gradle.com/build-cache/)
  * [企业文件](https://gradle.com/enterprise/resources/)

**得到帮助**

  * [论坛](https://discuss.gradle.org/c/help-discuss)
  * [的GitHub](https://github.com/gradle/)
  * [训练](https://gradle.com/training/)
  * [服务](https://gradle.org/services/)

##### 随时`UP-TO-DATE`关注新功能和新闻

输入您的电子邮件，即表示您同意我们的[条款](https://gradle.com/legal/terms-of-
service/)和[隐私政策](https://gradle.com/legal/privacy/)，包括接收电子邮件。您可以随时取消订阅。

订阅

© [Gradle Inc.](https://gradle.com/) 2020年 版权所有。

[ gradle ](file:///)

[招贤纳士](https://gradle.com/careers/)| [隐私](https://gradle.com/legal/privacy/)|
[服务条款](https://gradle.com/legal/terms-of-service/)|
[联系](https://gradle.org/contact/)

![Google 翻译](./JVM项目的工具链_files/translate_24dp.png)

# 原文

提供更好的翻译建议

* * *

