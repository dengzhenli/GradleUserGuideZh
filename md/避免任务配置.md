

[ Gradle ](https://docs.gradle.org/ "Gradle Docs")

用户手册

  * 社区 Open Community Menu

[ 社区之家 ](https://gradle.org/)

[ 社区论坛 ](https://discuss.gradle.org/)

[ 社区插件 ](https://plugins.gradle.org/)

  * [训练](https://gradle.com/training/)
  * 新闻 Open Community Menu

[ 通讯 ](https://newsletter.gradle.com/)

[ 博客 ](https://blog.gradle.org/)

[ 推特 ](https://twitter.com/gradle)

  * [企业](https://gradle.com/)
  * [github](https://github.com/gradle/gradle "GitHub上的Gradle")

  * [文件首页](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/userguide.html)
  * [样品](file:///Users/dxs/temp/gradle-6.7.1/docs/samples/index.html)
  * [发行说明](file:///Users/dxs/temp/gradle-6.7.1/docs/release-notes.html)
  * [Gradle API](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#gradle-api)
    * [Javadoc](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/index.html?overview-summary.html)
    * [Groovy DSL Reference](file:///Users/dxs/temp/gradle-6.7.1/docs/dsl/index.html)
    * [Groovy DSL Primer](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/groovy_build_script_primer.html)
    * [Kotlin DSL API](https://gradle.github.io/kotlin-dsl-docs/api/)
    * [Kotlin DSL Primer](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/kotlin_dsl.html)

### 用户手册

[ PDF格式 ](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/userguide.pdf)

  * [什么是Gradle？](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/what_is_gradle.html)
  * [入门](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/getting_started.html)
  * [安装Gradle](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/installation.html)
  * [升级Gradle ...](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#upgrading-gradle)
    * [version 6.X to latest](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/upgrading_version_6.html)
    * [version 5.X to 6.0](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/upgrading_version_5.html)
    * [version 4.X to 5.0](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/upgrading_version_4.html)
    * [Gradle's Feature Lifecycle](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/feature_lifecycle.html)
  * [迁移至Gradle ...](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#migrating-to-gradle)
    * [from Maven](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/migrating_from_maven.html)
    * [from Ant](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/migrating_from_ant.html)
  * [相容性说明](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/compatibility.html)
  * [对构建进行故障排除](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/troubleshooting.html)

### 运行Gradle构建

  * [自定义执行](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#customizing-execution)
    * [Configuring the Build Environment](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/build_environment.html)
    * [Configuring the Gradle Daemon](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/gradle_daemon.html)
    * [Using Initialization Scripts](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/init_scripts.html)
  * [执行多项目构建](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/intro_multi_project_builds.html)
  * [检查Gradle构建](https://scans.gradle.com/)
  * [优化构建时间](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#optimizing-build-performance)
    * [Build Performance Guide](https://guides.gradle.org/performance/)
    * [Enabling and Configuring the Build Cache](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/build_cache.html)
    * [Using the Configuration Cache](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/configuration_cache.html)

### 编写Gradle构建

  * [学习基础](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#learning-the-basics)
    * [Introducing the Basics of Build Scripts](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/tutorial_using_tasks.html)
    * [Working with Tasks](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/more_about_tasks.html)
    * [Learning More About Build Scripts](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/writing_build_scripts.html)
    * [Working with Files](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/working_with_files.html)
    * [Using Gradle Plugins](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/plugins.html)
    * [Understanding the Build Lifecycle](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/build_lifecycle.html)
    * [Working with Logging](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/logging.html)
    * [Avoiding Traps](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/potential_traps.html)
  * [创作多项目构建](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#authoring-multi-project-builds)
    * [Creating a Basic Multi-Project Build](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/multi_project_builds.html)
    * [Declaring Dependencies between Subprojects](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/declaring_dependencies_between_subprojects.html)
    * [Sharing Build Logic between Subprojects](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/sharing_build_logic_between_subprojects.html)
    * [Fine Tuning the Project Layout](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/fine_tuning_project_layout.html)
    * [Understanding Configuration and Execution](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/multi_project_configuration_and_execution.html)
  * [创作可持续建筑](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#authoring-sustainable-builds)
    * [Organizing Build Logic](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/organizing_gradle_projects.html)
    * [Following Best Practices](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/authoring_maintainable_build_scripts.html)
  * [先进技术](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#advanced-techniques)
    * [Developing Parallel Tasks](https://guides.gradle.org/using-the-worker-api/)
    * [Testing a Build with TestKit](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/test_kit.html)
    * [Using Ant from Gradle](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/ant.html)

### 编写JVM构建

  * [构建Java和JVM项目](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/building_java_projects.html)
  * [测试Java和JVM项目](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/java_testing.html)
  * [Java项目的工具链](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html)
  * [管理依赖关系](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_management_for_java_projects.html)
  * [JVM插件](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#jvm-plugins)
    * [Java Library Plugin](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/java_library_plugin.html)
    * [Java Application Plugin](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/application_plugin.html)
    * [Java Platform Plugin](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/java_platform_plugin.html)
    * [Groovy Plugin](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/groovy_plugin.html)
    * [Scala Plugin](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/scala_plugin.html)

### 编写C ++ / Swift构建

  * [构建C ++项目](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/building_cpp_projects.html)
  * [测试C ++项目](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/cpp_testing.html)
  * [建立Swift项目](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/building_swift_projects.html)
  * [测试Swift项目](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/swift_testing.html)

### 使用依赖项

  * [学习基础](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#learning-the-basics-dependency-management)
    * [What is Dependency Management?](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/core_dependency_management.html)
    * [Declaring Repositories](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/declaring_repositories.html)
    * [Declaring Dependencies](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/declaring_dependencies.html)
    * [Understanding Library and Application Differences](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/library_vs_application.html)
    * [Viewing and Debugging Dependencies](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/viewing_debugging_dependencies.html)
    * [Understanding Resolution](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_resolution.html)
    * [Verifying dependencies](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_verification.html)
  * [声明版本](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#declaring-dependency-versions)
    * [Declaring Versions and Ranges](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/single_versions.html)
    * [Declaring Rich Versions](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/rich_versions.html)
    * [Handling Changing Versions](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dynamic_versions.html)
    * [Locking Versions](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_locking.html)
  * [控制翻译](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#controlling-transitive-dependencies)
    * [Upgrading Versions](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_constraints.html)
    * [Downgrading and Excluding](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_downgrade_and_exclude.html)
    * [Sharing Versions](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/platforms.html)
    * [Aligning Dependencies](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_version_alignment.html)
    * [Handling Mutually Exclusive Dependencies](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_capability_conflict.html)
    * [Fixing Metadata](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/component_metadata_rules.html)
    * [Customizing Resolution](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/resolution_rules.html)
    * [Preventing accidental upgrades](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/resolution_strategy_tuning.html)
  * [图书馆的生产和消费形式](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#modeling-features)
    * [Declaring Capabilities of a Library](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/component_capabilities.html)
    * [Modeling Feature Variants and Optional Dependencies](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/feature_variants.html)
    * [Understanding Variant Selection](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/variant_model.html)
    * [Declaring Variant Attributes](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/variant_attributes.html)
    * [Sharing Outputs of Projects](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/cross_project_publications.html)
    * [Transforming Artifacts](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/artifact_transforms.html)
  * [在多仓库环境中工作](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#multi-repo)
    * [Composing Builds](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/composite_builds.html)
  * [出版图书馆](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#publishing)
    * [Setting up Publishing](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_setup.html)
    * [Understanding Gradle Module Metadata](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_gradle_module_metadata.html)
    * [Signing Artifacts](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_signing.html)
    * [Customizing Publishing](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_customization.html)
    * [Maven Publish Plugin](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_maven.html)
    * [Ivy Publish Plugin](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html)
  * [术语](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_management_terminology.html)

### 扩展摇篮

  * [插件开发教程](https://gradle.org/guides/?q=Plugin%20Development)
  * [编写Gradle任务类型](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/custom_tasks.html)
  * [编写Gradle插件](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/custom_plugins.html)
  * [编写自定义Gradle类型](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/custom_gradle_types.html)
  * [延迟配置任务](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/lazy_configuration.html)
  * [使用避免任务配置](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html)

### 参考

  * [核心插件](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/plugin_reference.html)
  * [命令行界面](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/command_line_interface.html)
  * [Gradle和第三方工具](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/third_party_integration.html)
  * [摇篮包装](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/gradle_wrapper.html)
  * [Gradle管理的目录](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/directory_layout.html)

# 避免任务配置

version 6.7.1

内容

  * [配置回避API如何工作？](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:how_does_it_work)
  * [指导方针](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:task_configuration_avoidance_guidelines)
  * [迁移指南](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:task_configuration_avoidance_migration_guidelines)
  * [现有与新API概述](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:old_vs_new_configuration_api_overview)

本章介绍了处理任务时的“避免配置”，并解释了一些有关迁移构建以有效使用避免配置API的准则。这里描述的API与现有的API共存，在几个主要版本中，这些API将被我们的常规弃用过程所取代。从Gradle
5.1开始，我们建议每当自定义插件创建任务时都使用避免配置API。

##
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:how_does_it_work)[配置回避API如何工作？](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:how_does_it_work)

简而言之，该API允许构建避免在Gradle的配置阶段（这些任务将永远不会执行）期间创建和配置任务的成本。例如，在运行编译任务时，将不会执行其他无关的任务，例如代码质量，测试和发布任务，因此无需花费任何时间来创建和配置这些任务。如果在构建过程中不需要任务，则避免配置API将避免配置任务，这可能会对总配置时间产生重大影响。

为了避免创建和配置任务，我们说任务是“已注册”但未创建。当任务处于这种状态时，它是构建已知的，可以对其进行配置，并且可以传递对其的引用，但是实际上尚未创建任务对象本身，并且没有执行任何配置操作。它将保持此状态，直到构建中需要实例化的任务对象为止（例如，如果该任务是在命令行上执行的，或者该任务是在命令行上执行的任务的依赖项）。如果不再需要任务对象，则任务将保持注册状态，从而避免了创建和配置任务的成本。

在Gradle中，您可以使用[TaskContainer.register（java.lang.String）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskContainer.html#register-
java.lang.String-)来注册任务。此方法有多种变体，允许提供任务类型和/或用于修改任务配置的操作。该`register(…​)`方法返回一个[TaskProvider](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskProvider.html)，而不是返回任务实例，它是对任务的引用，该引用可以在可能使用普通任务对象的许多地方使用（例如，在创建任务依赖项时）。

##
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:task_configuration_avoidance_guidelines)[指导方针](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:task_configuration_avoidance_guidelines)

###
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:how_do_i_defer_creation)[如何推迟任务创建？](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:how_do_i_defer_creation)

有效避免任务配置需要构建作者将[TaskContainer.create（java.lang.String）的](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskContainer.html#create-
java.lang.String-)实例更改为[TaskContainer.register（java.lang.String）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskContainer.html#register-
java.lang.String-)。

Older versions of Gradle only support the `create(…​)` API. The `create(…​)`
API eagerly creates and configures tasks when it is called and should be
avoided.

Using `register(…​)` alone may not be enough to avoid all task configuration
completely. You may need to change other code that configures tasks by name or
by type, as explained in the following sections.

###
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:how_do_i_defer_configuration)[How
do I defer task
configuration?](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:how_do_i_defer_configuration)

Eager APIs like
[DomainObjectCollection.all(org.gradle.api.Action)](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/DomainObjectCollection.html#all-
org.gradle.api.Action-) and [DomainObjectCollection.withType(java.lang.Class,
org.gradle.api.Action)](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/DomainObjectCollection.html#withType-
java.lang.Class-org.gradle.api.Action-) will immediately create and configure
any registered tasks. To defer task configuration, you will need to migrate to
a configuration avoidance API equivalent. See the [table
below](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:old_vs_new_configuration_api_overview)
to identify the alternative.

###
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:how_do_i_reference_a_task)[How
do I reference a task without creating/configuring
it?](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:how_do_i_reference_a_task)

Instead of referencing a task object, you can work with a registered task via
a
[TaskProvider](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskProvider.html)
object. A
[TaskProvider](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskProvider.html)
can be obtained in several ways including when calling
[TaskContainer.register(java.lang.String)](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskContainer.html#register-
java.lang.String-) or using the
[TaskCollection.named(java.lang.String)](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskCollection.html#named-
java.lang.String-) method.

Calling
[Provider.get()](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/provider/Provider.html#get--)
or looking up a task by name with
[TaskCollection.getByName(java.lang.String)](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskCollection.html#getByName-
java.lang.String-) will cause the task to be created and configured. Methods
like
[Task.dependsOn(java.lang.Object…​)](file:///Users/dxs/temp/gradle-6.7.1/docs/dsl/org.gradle.api.Task.html#org.gradle.api.Task:dependsOn\(java.lang.Object\[\]\))
and
[ConfigurableFileCollection.builtBy(java.lang.Object...)](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/file/ConfigurableFileCollection.html#builtBy-
java.lang.Object...-) work with
[TaskProvider](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskProvider.html)
in the same way as
[Task](file:///Users/dxs/temp/gradle-6.7.1/docs/dsl/org.gradle.api.Task.html),
so you do not need to unwrap a `Provider` for explicit dependencies to
continue to work.

If you are configuring a task by name, you will need to use the configuration
avoidance equivalent. See the [table
below](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:old_vs_new_configuration_api_overview)
to identify the alternative.

###
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:how_do_i_get_a_task)[How
to get an instance of a
Task?](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:how_do_i_get_a_task)

In the event you still need to get access to a Task instance, you can use
[TaskCollection.named(java.lang.String)](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskCollection.html#named-
java.lang.String-) and call
[Provider.get()](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/provider/Provider.html#get--).
This will cause the task to be created/configured, but everything should work
as it has with the eager APIs.

##
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:task_configuration_avoidance_migration_guidelines)[Migration
Guide](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:task_configuration_avoidance_migration_guidelines)

The following sections will go through some [general
guidelines](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:task_configuration_avoidance_general)
to adhere to when migrating the build logic as well as [the
steps](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:task_configuration_avoidance_migration_steps)
we recommend following. We also cover some
[troubleshooting](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:task_configuration_avoidance_troubleshooting)
and
[pitfalls](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:task_configuration_avoidance_pitfalls)
to help you work around some issues you may encounter during the migration.

###
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:task_configuration_avoidance_general)[General](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:task_configuration_avoidance_general)

  1. **使用`help`的任务，因为在迁移过程中的标杆。** 该`help`任务是基准测试迁移过程的理想人选。在仅使用配置避免API[的构建中](https://scans.gradle.com/s/o7qmlmmrsfxz4/performance/configuration?openScriptsAndPlugins=WzFd)，[构建扫描不会显示立即创建或在配置过程中创建](https://scans.gradle.com/s/o7qmlmmrsfxz4/performance/configuration?openScriptsAndPlugins=WzFd)的任务，而只会创建实际执行的任务。请注意所[使用的构建扫描插件的版本](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#task_configuration_avoidance_pitfall_build_scan_plugin)。

  2. **仅在配置操作中更改当前任务。** 因为任务配置操作现在可以立即，稍后或永远不会运行，所以对当前任务以外的任何其他变量进行更改都可能导致构建中行为不确定。考虑以下代码：

`Groovy``Kotlin`

    
        def check = tasks.register("check")
    tasks.register("verificationTask") { verificationTask ->
        // Configure verificationTask
    
        // Run verificationTask when someone runs check
        check.get().dependsOn verificationTask
    }
    
        val check by tasks.registering
    tasks.register("verificationTask") {
        // Configure verificationTask
    
        // Run verificationTask when someone runs check
        check.get().dependsOn(this)
    }

执行`gradle
check`任务应该执行`verificationTask`，但是在此示例中，它不会执行。这是因为之间的依赖关系`verificationTask`，并`check`只有当发生了`verificationTask`实现。为避免出现此类问题，您必须仅修改与配置操作关联的任务。其他任务应在自己的配置操作中进行修改。该代码将变为：

`Groovy``Kotlin`

    
        def check = tasks.register("check")
    def verificationTask = tasks.register("verificationTask") {
        // Configure verificationTask
    }
    check.configure {
        dependsOn verificationTask
    }
    
        val check by tasks.registering
    val verificationTask by tasks.registering {
        // Configure verificationTask
    }
    check {
        dependsOn(verificationTask)
    }

将来，Gradle会将这种反模式视为错误，并将产生异常。

  3. **最好是小的增量更改。** 较小的更改更易于检查。如果您破坏了构建逻辑，自上次成功验证以来，分析变更日志将更加容易。

  4. **确保建立用于验证构建逻辑的好的计划。** 通常，一个简单的`build`任务调用就可以完成验证您的构建逻辑的技巧。但是，某些内部版本可能需要其他验证-了解您内部版本的行为，并确保您有良好的验证计划。

  5. **与自动测试相比，首选自动测试。** 良好的做法是使用TestKit为您的构建逻辑编写集成测试。

  6. **避免按名称引用任务。** 在大多数情况下，按名称引用任务是一种脆弱的模式，应避免使用。尽管任务名称在上可用，但`TaskProvider`应努力使用来自强类型模型的引用。

  7. **尽可能使用新的任务API。** 急于实现某些任务可能会导致其他任务级联实现。使用`TaskProvider`有助于创建防止传递实现的间接访问。

  8. 如果您尝试从新API的配置块访问它们，则某些API可能会被禁止。例如， [`Project.afterEvaluate()`](file:///Users/dxs/temp/gradle-6.7.1/docs/dsl/org.gradle.api.Project.html#org.gradle.api.Project:afterEvaluate\(org.gradle.api.Action\)) 在配置使用新API注册的任务时无法调用。由于`afterEvaluate`用于延迟配置a `Project`，因此将延迟的配置与新API混合会导致难以诊断的错误，因为在新API中注册的任务并非总是配置，而是`afterEvaluate`可以期望始终执行一个块。

###
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:task_configuration_avoidance_migration_steps)[迁移步骤](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:task_configuration_avoidance_migration_steps)

迁移过程的第一部分是遍历代码并手动迁移渴望的任务创建和配置，以使用配置回避API。以下内容探讨了成功迁移的建议步骤。在执行这些步骤时，请记住上面[的准则](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:task_configuration_avoidance_general)。

__ |

在插件中使用新的API将要求用户使用Gradle
4.9或更高版本。插件作者应参考“[支持较早版本的Gradle”](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:task_configuration_avoidance_backward_compatibility_migration)部分。  
  
---|---  
  
  1. **迁移`tasks.all {}`按类型（`tasks.withType(…​) {}`）影响所有任务（）或子集的任务配置。** 这将导致您的构建急切地减少由插件注册的任务。

  2. **迁移按名称配置的任务。** 与上一点类似，这将导致您的构建急切地创建更少的插件注册的任务。例如，使用的逻辑`TaskContainer#getByName(String, Closure/Action)`应转换为`TaskContainer#named(String).configure(Closure/Action)`。这还包括[通过DSL块进行的任务配置](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#task_configuration_avoidance_pitfalls_hidden_eager_task_realization)。

  3. **将任务创建迁移到`register(…​)`。** 此时，您应该更改要创建任务的任何位置，以代替注册这些任务。

对于上述所有步骤，请注意[延迟配置周围](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:task_configuration_avoidance_pitfalls)的[常见陷阱](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:task_configuration_avoidance_pitfalls)。

进行了这些更改之后，您应该会看到在配置时急切创建的任务数量有所改善。使用[构建扫描](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:task_configuration_avoidance_troubleshooting)来了解仍在急切创建哪些任务以及发生的位置。

###
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:task_configuration_avoidance_troubleshooting)[故障排除](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:task_configuration_avoidance_troubleshooting)

  * **正在实现什么任务？** 随着我们不断开发该功能，将提供更多报告和故障排除信息来回答此问题。同时，[构建扫描是回答此问题的最佳方法](https://gradle.com/enterprise/releases/2018.3#reduce-configuration-time-by-leveraging-task-creation-avoidance)。跟着这些步骤：

    1. [创建一个构建扫描](https://scans.gradle.com/)。使用该`--scan`标志执行Gradle命令。

    2. 导航到配置性能选项卡。

![taskConfigurationAvoidance导航至性能](./避免任务配置_files/taskConfigurationAvoidance-
navigate-to-performance.png)

图1.导航到构建扫描中的“配置性能”选项卡

      1. 从左侧菜单导航到性能卡。

      2. 从性能卡顶部导航到“配置”选项卡。

    3. 将显示所有需要的信息。

![注释taskConfigurationAvoidance性能](./避免任务配置_files/taskConfigurationAvoidance-
performance-annotated.png)

图2.带有注释的构建扫描中的“配置性能”选项卡

      1. 不论是否创建每个任务，总的任务数。

        * “立即创建”表示使用急切任务API创建的任务。

        * “在配置过程中创建”表示使用避免配置API创建的任务，但是`TaskProvider#get()`使用渴望任务查询API明确（通过）或隐式实现的任务。

        * “立即创建”和“在配置过程中创建”这两个数字均被视为“不良”数字，应尽可能减少这些数字。

        * “在任务图计算期间创建”表示构建执行任务图时创建的任务。理想情况下，此数量应等于已执行任务的数量。

        * “未创建”表示在此构建会话中避免的任务。

      2. 下一节将帮助回答在哪里实现任务的问题。对于每个脚本，插件或生命周期回调，最后一列表示立即或在配置过程中创建的任务。理想情况下，此列应为空。

      3. 关注脚本，插件或生命周期回调将显示已创建任务的分解。

###
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:task_configuration_avoidance_pitfalls)[陷阱](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:task_configuration_avoidance_pitfalls)

  * **当心隐藏的渴望任务的实现。** 可以通过多种方法来快速配置任务。例如，使用任务名称和DSL块配置任务将导致立即创建任务：
    
        // Given a task lazily created with
    tasks.register("someTask")
    
    // Some time later, the task is configured using a DSL block
    someTask {
        // This causes the task to be created and this configuration to be executed immediately
    }

而是使用该`named()`方法来获取对该任务的引用并进行配置：

    
        tasks.named("someTask").configure {
        // ...
        // Beware of the pitfalls here
    }

同样，Gradle具有语法糖，该语法糖允许通过名称引用任务，而无需使用显式的查询方法。这也会导致立即创建任务：

    
        tasks.register("someTask")
    
    // Sometime later, an eager task is configured like
    task anEagerTask {
        // The following will cause "someTask" to be looked up and immediately created
        dependsOn someTask
    }

有几种方法可以避免这种过早的创建：

    * **使用`TaskProvider`变量。** 在同一构建脚本中多次引用任务时很有用。

`Groovy``Kotlin`

        
                def someTask = tasks.register("someTask")
        
        task anEagerTask {
            dependsOn someTask
        }
        
                val someTask by tasks.registering
        
        task("anEagerTask") {
            dependsOn(someTask)
        }

    * **将使用者任务迁移到新的API。**
        
                tasks.register("someTask")
        
        tasks.register("anEagerTask") {
            dependsOn someTask
        }

    * **懒惰地查找任务。** 当任务不是由同一插件创建时有用。

`Groovy``Kotlin`

        
                tasks.register("someTask")
        
        task anEagerTask {
            dependsOn tasks.named("someTask")
        }
        
                tasks.register("someTask")
        
        task("anEagerTask") {
            dependsOn(tasks.named("someTask"))
        }

  * **`buildScanPublishPrevious` 直到版本1.15才开始进行构建扫描插件任务。**升级构建中的构建扫描插件以使用最新版本。

####
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:task_configuration_avoidance_backward_compatibility_migration)[支持较旧版本的Gradle](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:task_configuration_avoidance_backward_compatibility_migration)

本节描述了两种方法，可以在必须与4.9之前的Gradle版本保持兼容性的情况下，使您的插件与Gradle的较早版本向后兼容。从Gradle
4.9开始，大多数新的API方法都可用。

__ |

尽管向后兼容性对用户有利，但我们仍建议您及时升级到较新的Gradle版本。这将减轻您的维护负担。  
  
---|---  
  
保持兼容性的第一种方法是根据Gradle 4.9
API编译插件，并使用Groovy有条件地调用正确的API（[示例](https://github.com/melix/jmh-gradle-
plugin/blob/a034aa88805b7a06fa9c5a825d573554b2aa23e2/src/main/groovy/me/champeau/gradle/JMHPlugin.groovy#L289-L296)）。

第二种方法是使用Java反射来解决API在编译期间不可用的事实（[示例](https://github.com/tbroyer/gradle-apt-
plugin/tree/432509ec85d1ab49296d4f9b21fad876523c6a8a/src/main/java/net/ltgt/gradle/apt)）。

强烈建议使用[TestKit](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/test_kit.html#sub:gradle-
runner-gradle-version)和多个版本的Gradle进行跨版本测试。

##
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:old_vs_new_configuration_api_overview)[现有与新API概述](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html#sec:old_vs_new_configuration_api_overview)

__ |

  * 该采取的方法`groovy.lang.Closure`覆盖新的API与方法服用`org.gradle.api.Action`。

  * 将来可能会基于用户反馈添加更多便捷方法。

  * 某些旧的API方法可能永远无法在新的API中直接替换。

  * 在通过配置避免方法注册的配置操作中访问某些API时，可能会受到限制。

  
  
---|---  
  
新旧API | 描述  
---|---  
  
代替： `task myTask(type: MyTask) {}`

|

没有使用新API的速记Groovy DSL。  
  
使用： `tasks.register("myTask", MyTask) {}`  
  
代替：[TaskContainer.create（java.util.Map）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskContainer.html#create-
java.util.Map-)

|

使用以下替代方法之一。  
  
使用：无直接等效。  
  
代替：[TaskContainer.create（java.util.Map，groovy.lang.Closure）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskContainer.html#create-
java.util.Map-groovy.lang.Closure-)

|

使用以下替代方法之一。  
  
使用：无直接等效。  
  
代替：[TaskContainer.create（java.lang.String）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskContainer.html#create-
java.lang.String-)

|

这将返回`TaskProvider`而不是`Task`。  
  
使用：[TaskContainer.register（java.lang.String）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskContainer.html#register-
java.lang.String-)  
  
代替：[TaskContainer.create（java.lang.String，groovy.lang.Closure）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskContainer.html#create-
java.lang.String-groovy.lang.Closure-)

|

这将返回`TaskProvider`而不是`Task`。  
  
使用：[TaskContainer.register（java.lang.String，org.gradle.api.Action）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskContainer.html#register-
java.lang.String-org.gradle.api.Action-)  
  
代替：[TaskContainer.create（java.lang.String，java.lang.Class）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskContainer.html#create-
java.lang.String-java.lang.Class-)

|

这将返回`TaskProvider`而不是`Task`。  
  
使用：[TaskContainer.register（java.lang.String，java.lang.Class）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskContainer.html#register-
java.lang.String-java.lang.Class-)  
  
代替：[TaskContainer.create（java.lang.String，java.lang.Class，org.gradle.api.Action）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskContainer.html#create-
java.lang.String-java.lang.Class-org.gradle.api.Action-)

|

这将返回`TaskProvider`而不是`Task`。  
  
使用：[TaskContainer.register（java.lang.String，java.lang.Class，org.gradle.api.Action）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskContainer.html#register-
java.lang.String-java.lang.Class-org.gradle.api.Action-)  
  
代替：[TaskContainer.create（java.lang.String，java.lang.Class，java.lang.Object…](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskContainer.html#create-
java.lang.String-java.lang.Class-java.lang.Object...-)

|

这将返回`TaskProvider`而不是`Task`。  
  
用途：[TaskContainer.register（java.lang.String，java.lang.Class，java.lang.Object…。）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskContainer.html#register-
java.lang.String-java.lang.Class-java.lang.Object...-)  
  
代替：[TaskCollection.getByName（java.lang.String）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskCollection.html#getByName-
java.lang.String-)

|

这将返回`TaskProvider`而不是`Task`。  
  
使用：[TaskCollection.named（java.lang.String）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskCollection.html#named-
java.lang.String-)  
  
而不是：[TaskCollection.getByName（java.lang.String，groovy.lang.Closure）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskCollection.html#getByName-
java.lang.String-groovy.lang.Closure-)

|

这将返回`TaskProvider`而不是`Task`。  
  
使用： `named(java.lang.String).configure(Action)`  
  
代替：[TaskContainer.getByPath（java.lang.String）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskContainer.html#getByPath-
java.lang.String-)

|

从另一个项目访问任务需要对项目评估进行特定排序。  
  
使用：无直接等效。  
  
代替：[NamedDomainObjectCollection.findByName（java.lang.String）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/NamedDomainObjectCollection.html#findByName-
java.lang.String-)

|

`named(String)`是最接近的等效项，但是如果任务不存在，将失败。使用`findByName(String)`将导致创建/配置使用新API注册的任务。  
  
使用：无直接等效。  
  
代替：[TaskContainer.findByPath（java.lang.String）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskContainer.html#findByPath-
java.lang.String-)

|

见`getByPath(String)`上文。  
  
使用：无直接等效。  
  
代替：[TaskCollection.withType（java.lang.Class）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskCollection.html#withType-
java.lang.Class-)

|

可以使用此方法，因为它不需要立即创建任务。  
  
使用： _可以_  
  
代替： `withType(java.lang.Class).getByName(java.lang.String)`

|

这将返回`TaskProvider`而不是`Task`。  
  
使用： `named(java.lang.String, java.lang.Class)`  
  
而不是：[DomainObjectCollection.withType（java.lang.Class，org.gradle.api.Action）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/DomainObjectCollection.html#withType-
java.lang.Class-org.gradle.api.Action-)

|

这将返回`void`，因此无法链接。  
  
使用： `withType(java.lang.Class).configureEach(org.gradle.api.Action)`  
  
代替：[DomainObjectCollection.all（org.gradle.api.Action）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/DomainObjectCollection.html#all-
org.gradle.api.Action-)

|

这将返回`void`，因此无法链接。  
  
使用：[DomainObjectCollection.configureEach（org.gradle.api.Action）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/DomainObjectCollection.html#configureEach-
org.gradle.api.Action-)  
  
代替：[TaskCollection.whenTaskAdded（org.gradle.api.Action）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskCollection.html#whenTaskAdded-
org.gradle.api.Action-)

|

这将返回`void`，因此无法链接。  
  
使用：[DomainObjectCollection.configureEach（org.gradle.api.Action）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/DomainObjectCollection.html#configureEach-
org.gradle.api.Action-)  
  
代替：[DomainObjectCollection.whenObjectAdded（org.gradle.api.Action）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/DomainObjectCollection.html#whenObjectAdded-
org.gradle.api.Action-)

|

这将返回`void`，因此无法链接。  
  
使用：[DomainObjectCollection.configureEach（org.gradle.api.Action）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/DomainObjectCollection.html#configureEach-
org.gradle.api.Action-)  
  
代替：[NamedDomainObjectSet.findAll（groovy.lang.Closure）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/NamedDomainObjectSet.html#findAll-
groovy.lang.Closure-)

|

避免调用此方法。`matching(Spec)`并且`configureEach(Action)`在大多数情况下更合适。  
  
使用： _确定_ ，有问题。  
  
代替：[TaskCollection.matching（groovy.lang.Closure）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskCollection.html#matching-
groovy.lang.Closure-)

|

可以使用此方法，因为它不需要立即创建任务。  
  
使用： _可以_  
  
代替：[TaskCollection.getAt（java.lang.String）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskCollection.html#getAt-
java.lang.String-)

|

避免直接调用它，因为这是Groovy的便捷方法。备选方案返回a`TaskProvider`而不是`Task`。  
  
使用：[TaskCollection.named（java.lang.String）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskCollection.html#named-
java.lang.String-)  
  
代替：`iterator()`或对`Task`集合进行隐式迭代

|

避免这样做，因为它需要创建和配置所有任务。见`findAll(Closure)`上文。  
  
使用： _确定_ ，有问题。  
  
代替： `remove(org.gradle.api.Task)`

|

避免调用此。`remove`新API的行为将来可能会改变。  
  
使用： _确定_ ，有问题。  
  
代替：[TaskContainer.replace（java.lang.String）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskContainer.html#replace-
java.lang.String-)

|

避免调用此。`replace`新API的行为将来可能会改变。  
  
使用： _确定_ ，有问题。  
  
代替：[TaskContainer.replace（java.lang.String，java.lang.Class）](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/tasks/TaskContainer.html#replace-
java.lang.String-java.lang.Class-)

|

避免调用此。`replace`新API的行为将来可能会改变。  
  
使用： _确定_ ，有问题。  
  
**文件**

  * [用户手册](file:///userguide/userguide.html)
  * [DSL参考](file:///dsl/)
  * [发行说明](file:///release-notes.html)
  * [Java文档](file:///javadoc/)

**新闻**

  * [博客](https://blog.gradle.org/)
  * [通讯](https://newsletter.gradle.com/)
  * [推特](https://twitter.com/gradle)
  * [状态页](https://status.gradle.com/)

**产品展示**

  * [构建扫描](https://gradle.com/build-scans/)
  * [构建缓存](https://gradle.com/build-cache/)
  * [企业文件](https://gradle.com/enterprise/resources/)

**得到帮助**

  * [论坛](https://discuss.gradle.org/c/help-discuss)
  * [的GitHub](https://github.com/gradle/)
  * [训练](https://gradle.com/training/)
  * [服务](https://gradle.org/services/)

##### 随时`UP-TO-DATE`关注新功能和新闻

输入您的电子邮件，即表示您同意我们的[条款](https://gradle.com/legal/terms-of-
service/)和[隐私政策](https://gradle.com/legal/privacy/)，包括接收电子邮件。您可以随时取消订阅。

订阅

© [Gradle Inc.](https://gradle.com/) 2020年 版权所有。

[ gradle ](file:///)

[招贤纳士](https://gradle.com/careers/)| [隐私](https://gradle.com/legal/privacy/)|
[服务条款](https://gradle.com/legal/terms-of-service/)|
[联系](https://gradle.org/contact/)

![Google 翻译](./避免任务配置_files/translate_24dp.png)

# 原文

提供更好的翻译建议

* * *

