

[ Gradle ](https://docs.gradle.org/ "Gradle Docs")

用户手册

  * 社区 Open Community Menu

[ 社区之家 ](https://gradle.org/)

[ 社区论坛 ](https://discuss.gradle.org/)

[ 社区插件 ](https://plugins.gradle.org/)

  * [训练](https://gradle.com/training/)
  * 新闻 Open Community Menu

[ 通讯 ](https://newsletter.gradle.com/)

[ 博客 ](https://blog.gradle.org/)

[ 推特 ](https://twitter.com/gradle)

  * [企业](https://gradle.com/)
  * [github](https://github.com/gradle/gradle "GitHub上的Gradle")

  * [文件首页](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/userguide.html)
  * [样品](file:///Users/dxs/temp/gradle-6.7.1/docs/samples/index.html)
  * [发行说明](file:///Users/dxs/temp/gradle-6.7.1/docs/release-notes.html)
  * [Gradle API](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#gradle-api)
    * [Java文档](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/index.html?overview-summary.html)
    * [Groovy DSL参考](file:///Users/dxs/temp/gradle-6.7.1/docs/dsl/index.html)
    * [Groovy DSL入门](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/groovy_build_script_primer.html)
    * [Kotlin DSL API](https://gradle.github.io/kotlin-dsl-docs/api/)
    * [Kotlin DSL入门](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/kotlin_dsl.html)

### 用户手册

[ PDF格式 ](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/userguide.pdf)

  * [什么是Gradle？](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/what_is_gradle.html)
  * [入门](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/getting_started.html)
  * [安装Gradle](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/installation.html)
  * [升级Gradle ...](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#upgrading-gradle)
    * [版本6.X到最新](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/upgrading_version_6.html)
    * [版本5.X到6.0](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/upgrading_version_5.html)
    * [版本4.X到5.0](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/upgrading_version_4.html)
    * [Gradle的功能生命周期](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/feature_lifecycle.html)
  * [迁移至Gradle ...](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#migrating-to-gradle)
    * [从Maven](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/migrating_from_maven.html)
    * [from Ant](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/migrating_from_ant.html)
  * [相容性说明](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/compatibility.html)
  * [对构建进行故障排除](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/troubleshooting.html)

### 运行Gradle构建

  * [自定义执行](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#customizing-execution)
    * [Configuring the Build Environment](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/build_environment.html)
    * [Configuring the Gradle Daemon](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/gradle_daemon.html)
    * [Using Initialization Scripts](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/init_scripts.html)
  * [执行多项目构建](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/intro_multi_project_builds.html)
  * [检查Gradle构建](https://scans.gradle.com/)
  * [优化构建时间](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#optimizing-build-performance)
    * [Build Performance Guide](https://guides.gradle.org/performance/)
    * [Enabling and Configuring the Build Cache](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/build_cache.html)
    * [Using the Configuration Cache](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/configuration_cache.html)

### 编写Gradle构建

  * [学习基础](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#learning-the-basics)
    * [Introducing the Basics of Build Scripts](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/tutorial_using_tasks.html)
    * [Working with Tasks](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/more_about_tasks.html)
    * [Learning More About Build Scripts](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/writing_build_scripts.html)
    * [Working with Files](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/working_with_files.html)
    * [Using Gradle Plugins](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/plugins.html)
    * [Understanding the Build Lifecycle](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/build_lifecycle.html)
    * [Working with Logging](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/logging.html)
    * [Avoiding Traps](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/potential_traps.html)
  * [创作多项目构建](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#authoring-multi-project-builds)
    * [Creating a Basic Multi-Project Build](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/multi_project_builds.html)
    * [Declaring Dependencies between Subprojects](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/declaring_dependencies_between_subprojects.html)
    * [Sharing Build Logic between Subprojects](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/sharing_build_logic_between_subprojects.html)
    * [Fine Tuning the Project Layout](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/fine_tuning_project_layout.html)
    * [Understanding Configuration and Execution](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/multi_project_configuration_and_execution.html)
  * [创作可持续建筑](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#authoring-sustainable-builds)
    * [Organizing Build Logic](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/organizing_gradle_projects.html)
    * [Following Best Practices](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/authoring_maintainable_build_scripts.html)
  * [先进技术](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#advanced-techniques)
    * [Developing Parallel Tasks](https://guides.gradle.org/using-the-worker-api/)
    * [Testing a Build with TestKit](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/test_kit.html)
    * [Using Ant from Gradle](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/ant.html)

### 编写JVM构建

  * [构建Java和JVM项目](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/building_java_projects.html)
  * [测试Java和JVM项目](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/java_testing.html)
  * [Java项目的工具链](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/toolchains.html)
  * [管理依赖关系](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_management_for_java_projects.html)
  * [JVM插件](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#jvm-plugins)
    * [Java Library Plugin](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/java_library_plugin.html)
    * [Java Application Plugin](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/application_plugin.html)
    * [Java Platform Plugin](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/java_platform_plugin.html)
    * [Groovy Plugin](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/groovy_plugin.html)
    * [Scala Plugin](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/scala_plugin.html)

### 编写C ++ / Swift构建

  * [构建C ++项目](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/building_cpp_projects.html)
  * [测试C ++项目](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/cpp_testing.html)
  * [建立Swift项目](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/building_swift_projects.html)
  * [测试Swift项目](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/swift_testing.html)

### 使用依赖项

  * [学习基础](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#learning-the-basics-dependency-management)
    * [What is Dependency Management?](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/core_dependency_management.html)
    * [Declaring Repositories](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/declaring_repositories.html)
    * [Declaring Dependencies](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/declaring_dependencies.html)
    * [Understanding Library and Application Differences](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/library_vs_application.html)
    * [Viewing and Debugging Dependencies](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/viewing_debugging_dependencies.html)
    * [Understanding Resolution](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_resolution.html)
    * [Verifying dependencies](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_verification.html)
  * [声明版本](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#declaring-dependency-versions)
    * [Declaring Versions and Ranges](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/single_versions.html)
    * [Declaring Rich Versions](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/rich_versions.html)
    * [Handling Changing Versions](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dynamic_versions.html)
    * [Locking Versions](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_locking.html)
  * [控制翻译](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#controlling-transitive-dependencies)
    * [Upgrading Versions](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_constraints.html)
    * [Downgrading and Excluding](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_downgrade_and_exclude.html)
    * [Sharing Versions](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/platforms.html)
    * [Aligning Dependencies](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_version_alignment.html)
    * [Handling Mutually Exclusive Dependencies](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_capability_conflict.html)
    * [Fixing Metadata](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/component_metadata_rules.html)
    * [Customizing Resolution](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/resolution_rules.html)
    * [Preventing accidental upgrades](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/resolution_strategy_tuning.html)
  * [图书馆的生产和消费形式](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#modeling-features)
    * [Declaring Capabilities of a Library](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/component_capabilities.html)
    * [Modeling Feature Variants and Optional Dependencies](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/feature_variants.html)
    * [Understanding Variant Selection](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/variant_model.html)
    * [Declaring Variant Attributes](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/variant_attributes.html)
    * [Sharing Outputs of Projects](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/cross_project_publications.html)
    * [Transforming Artifacts](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/artifact_transforms.html)
  * [在多仓库环境中工作](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#multi-repo)
    * [Composing Builds](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/composite_builds.html)
  * [出版图书馆](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#publishing)
    * [设置发布](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_setup.html)
    * [了解Gradle模块元数据](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_gradle_module_metadata.html)
    * [签署文物](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_signing.html)
    * [定制出版](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_customization.html)
    * [Maven发布插件](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_maven.html)
    * [常春藤发布插件](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html)
  * [术语](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_management_terminology.html)

### 扩展摇篮

  * [插件开发教程](https://gradle.org/guides/?q=Plugin%20Development)
  * [编写Gradle任务类型](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/custom_tasks.html)
  * [编写Gradle插件](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/custom_plugins.html)
  * [编写自定义Gradle类型](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/custom_gradle_types.html)
  * [延迟配置任务](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/lazy_configuration.html)
  * [使用避免任务配置](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/task_configuration_avoidance.html)

### 参考

  * [核心插件](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/plugin_reference.html)
  * [命令行界面](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/command_line_interface.html)
  * [Gradle和第三方工具](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/third_party_integration.html)
  * [摇篮包装](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/gradle_wrapper.html)
  * [Gradle管理的目录](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/directory_layout.html)

# 常春藤发布插件

version 6.7.1

内容

  * [用法](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#publishing_ivy:usage)
  * [任务](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#publishing_ivy:tasks)
  * [刊物](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#publishing_ivy:publications)
  * [储存库](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#publishing_ivy:repositories)
  * [完整的例子](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#publishing_ivy:example)
  * [从旧版Ivy出版物迁移](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#sec:pub_ivy:legacy_migration)

Ivy Publish插件提供了以[Apache
Ivy](http://ant.apache.org/ivy/)格式发布构建工件的功能，通常将其发布到存储库以供其他构建或项目使用。发布的内容是由构建创建的一个或多个工件，以及一个Ivy
_模块描述符_ （通常为`ivy.xml`），该描述 _符_ 描述了工件及其相关性（如果有）。

Gradle（请参阅[声明依赖项](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/declaring_dependencies.html#declaring-
dependencies)）和其他了解Ivy格式的工具可以使用已发布的Ivy模块。您可以在[发布概述中](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_setup.html#publishing_overview)了解发布的基础知识。

##
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#publishing_ivy:usage)[用法](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#publishing_ivy:usage)

要使用Ivy Publish插件，请在构建脚本中包括以下内容：

例子1.应用Ivy Publish插件

`Groovy``Kotlin`

build.gradle

    
    
    plugins {
        id 'ivy-publish'
    }

build.gradle.kts

    
    
    plugins {
        `ivy-publish`
    }

Ivy
Publish插件在项目上使用扩展名`publishing`，类型为[PublishingExtension](file:///Users/dxs/temp/gradle-6.7.1/docs/dsl/org.gradle.api.publish.PublishingExtension.html)。此扩展提供了一个命名出版物的容器和一个命名存储库的容器。Ivy
Publish插件可与[IvyPublication](file:///Users/dxs/temp/gradle-6.7.1/docs/dsl/org.gradle.api.publish.ivy.IvyPublication.html)出版物和[IvyArtifactRepository](file:///Users/dxs/temp/gradle-6.7.1/docs/dsl/org.gradle.api.artifacts.repositories.IvyArtifactRepository.html)仓库一起使用。

##
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#publishing_ivy:tasks)[任务](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#publishing_ivy:tasks)

`generateDescriptorFileFor _PubName_ Publication`—
[GenerateIvyDescriptor](file:///Users/dxs/temp/gradle-6.7.1/docs/dsl/org.gradle.api.publish.ivy.tasks.GenerateIvyDescriptor.html)

    

为名为 _PubName_ 的发布创建一个Ivy描述符文件，填充已知的元数据，例如项目名称，项目版本和依赖项。描述符文件的默认位置是 _build /
publications / $ pubName / ivy.xml_ 。

`publish _PubName_ PublicationTo _RepoName_ Repository`—
[PublishToIvyRepository](file:///Users/dxs/temp/gradle-6.7.1/docs/dsl/org.gradle.api.publish.ivy.tasks.PublishToIvyRepository.html)

    

将 _PubName_ 发布发布到名为 _RepoName_ 的存储库。如果您具有没有明确名称的存储库定义，则 _RepoName_ 将为“ Ivy”。

`publish`

    

_取决于_ ：所有任务`publish _PubName_ PublicationTo _RepoName_ Repository`

将所有定义的发布发布到所有定义的存储库的聚合任务。

##
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#publishing_ivy:publications)[刊物](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#publishing_ivy:publications)

此插件提供[出版物](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_management_terminology.html#sub:terminology_publication)类型的[IvyPublication](file:///Users/dxs/temp/gradle-6.7.1/docs/dsl/org.gradle.api.publish.ivy.IvyPublication.html)。要了解如何定义和使用出版物，请参见[基本出版](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_setup.html#sec:basic_publishing)部分。

您可以在Ivy发布中配置以下四项主要内容：

  * 一个[组件](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_management_terminology.html#sub:terminology_component)—通过[IvyPublication.from（org.gradle.api.component.SoftwareComponent）](file:///Users/dxs/temp/gradle-6.7.1/docs/dsl/org.gradle.api.publish.ivy.IvyPublication.html#org.gradle.api.publish.ivy.IvyPublication:from\(org.gradle.api.component.SoftwareComponent\))。

  * [自定义工件](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_customization.html#sec:publishing_custom_artifacts_to_maven)-通过[IvyPublication.artifact（java.lang.Object）](file:///Users/dxs/temp/gradle-6.7.1/docs/dsl/org.gradle.api.publish.ivy.IvyPublication.html#org.gradle.api.publish.ivy.IvyPublication:artifact\(java.lang.Object\))方法。有关自定义Ivy工件的可用配置选项，请参见[IvyArtifact](file:///Users/dxs/temp/gradle-6.7.1/docs/dsl/org.gradle.api.publish.ivy.IvyArtifact.html)。

  * 标准元数据一样`module`，`organisation`和`revision`。

  * 模块描述符的其他内容-通过[IvyPublication.descriptor（org.gradle.api.Action）](file:///Users/dxs/temp/gradle-6.7.1/docs/dsl/org.gradle.api.publish.ivy.IvyPublication.html#org.gradle.api.publish.ivy.IvyPublication:descriptor\(org.gradle.api.Action\))。

您可以在[完整的发布示例中](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#publishing_ivy:example)看到所有这些内容。的API文档`IvyPublication`还有其他代码示例。

###
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#sec:identity_values_for_the_published_project)[已发布项目的标识值](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#sec:identity_values_for_the_published_project)

生成的Ivy模块描述符文件包含一个`<info>`标识模块的元素。默认标识值从以下派生：

  * `organisation`\- [Project.getGroup（）](file:///Users/dxs/temp/gradle-6.7.1/docs/dsl/org.gradle.api.Project.html#org.gradle.api.Project:group)

  * `module`\- [Project.getName（）](file:///Users/dxs/temp/gradle-6.7.1/docs/dsl/org.gradle.api.Project.html#org.gradle.api.Project:name)

  * `revision`\- [Project.getVersion（）](file:///Users/dxs/temp/gradle-6.7.1/docs/dsl/org.gradle.api.Project.html#org.gradle.api.Project:version)

  * `status`\- [Project.getStatus（）](file:///Users/dxs/temp/gradle-6.7.1/docs/dsl/org.gradle.api.Project.html#org.gradle.api.Project:status)

  * `branch` \- （没有设置）

覆盖默认标识值非常简单：只需指定`organisation`，`module`或`revision`配置属性时[IvyPublication](file:///Users/dxs/temp/gradle-6.7.1/docs/dsl/org.gradle.api.publish.ivy.IvyPublication.html)。`status`并`branch`可以通过`descriptor`属性设置-
请参见[IvyModuleDescriptorSpec](file:///Users/dxs/temp/gradle-6.7.1/docs/dsl/org.gradle.api.publish.ivy.IvyModuleDescriptorSpec.html)。

该`descriptor`属性还可以用于添加其他自定义元素作为该`<info>`元素的子元素，如下所示：

例子2.定制发布标识

`Groovy``Kotlin`

build.gradle

    
    
    publishing {
        publications {
            ivy(IvyPublication) {
                organisation = 'org.gradle.sample'
                module = 'project1-sample'
                revision = '1.1'
                descriptor.status = 'milestone'
                descriptor.branch = 'testing'
                descriptor.extraInfo 'http://my.namespace', 'myElement', 'Some value'
    
                from components.java
            }
        }
    }

build.gradle.kts

    
    
    publishing {
        publications {
            create<IvyPublication>("ivy") {
                organisation = "org.gradle.sample"
                module = "project1-sample"
                revision = "1.1"
                descriptor.status = "milestone"
                descriptor.branch = "testing"
                descriptor.extraInfo("http://my.namespace", "myElement", "Some value")
    
                from(components["java"])
            }
        }
    }

__ |

某些存储库无法处理所有受支持的字符。例如，`:`当发布到Windows上由文件系统支持的存储库时，该字符不能用作标识符。  
  
---|---  
  
摇篮将处理任何有效的Unicode字符`organisation`，`module`和`revision`（以及神器的`name`，`extension`和`classifier`）。明确禁止的唯一值是`\`，`/`以及任何ISO控制字符。提供的值在发布过程的早期就得到了验证。

###
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#sec:modifying_the_generated_module_descriptor)[自定义生成的模块描述符](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#sec:modifying_the_generated_module_descriptor)

有时，从项目信息生成的模块描述符文件将需要在发布之前进行调整。Ivy Publish Plugin为此提供了DSL。请参阅《
DSL参考》中的[IvyModuleDescriptorSpec](file:///Users/dxs/temp/gradle-6.7.1/docs/dsl/org.gradle.api.publish.ivy.IvyModuleDescriptorSpec.html)，以获取可用属性和方法的完整文档。

以下示例显示了如何使用DSL最常见的方面：

例子3.定制模块描述符文件

`Groovy``Kotlin`

build.gradle

    
    
        publications {
            ivyCustom(IvyPublication) {
                descriptor {
                    license {
                        name = 'The Apache License, Version 2.0'
                        url = 'http://www.apache.org/licenses/LICENSE-2.0.txt'
                    }
                    author {
                        name = 'Jane Doe'
                        url = 'http://example.com/users/jane'
                    }
                    description {
                        text = 'A concise description of my library'
                        homepage = 'http://www.example.com/library'
                    }
                }
                versionMapping {
                    usage('java-api') {
                        fromResolutionOf('runtimeClasspath')
                    }
                    usage('java-runtime') {
                        fromResolutionResult()
                    }
                }
            }
        }

build.gradle.kts

    
    
        publications {
            create<IvyPublication>("ivyCustom") {
                descriptor {
                    license {
                        name.set("The Apache License, Version 2.0")
                        url.set("http://www.apache.org/licenses/LICENSE-2.0.txt")
                    }
                    author {
                        name.set("Jane Doe")
                        url.set("http://example.com/users/jane")
                    }
                    description {
                        text.set("A concise description of my library")
                        homepage.set("http://www.example.com/library")
                    }
                }
                versionMapping {
                    usage("java-api") {
                        fromResolutionOf("runtimeClasspath")
                    }
                    usage("java-runtime") {
                        fromResolutionResult()
                    }
                }
            }
        }

在此示例中，我们只是在生成的Ivy依赖项描述符中添加了一个'description'元素，但是该钩子允许您修改生成的描述符的任何方面。例如，您可以将依赖关系的版本范围替换为用于生成内部版本的实际版本。

您还可以通过[IvyModuleDescriptorSpec.withXml（org.gradle.api.Action）](file:///Users/dxs/temp/gradle-6.7.1/docs/dsl/org.gradle.api.publish.ivy.IvyModuleDescriptorSpec.html#org.gradle.api.publish.ivy.IvyModuleDescriptorSpec:withXml\(org.gradle.api.Action\))将任意XML添加到描述符文件中，但是不能使用它来修改模块标识符的任何部分（组织，模块，修订版）。

__ |  可以以不再是有效的Ivy模块描述符的方式修改描述符，因此在使用此功能时必须小心。  
---|---  
  
###
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#publishing_ivy:resolved_dependencies)[自定义依赖版本](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#publishing_ivy:resolved_dependencies)

支持两种策略来发布依赖项：

声明的版本（默认）

    

此策略使用`dependencies`块中的依赖项声明发布由构建脚本作者定义的版本。发布不会考虑任何其他类型的处理，例如通过[更改已解决版本的规则](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/resolution_rules.html)。

解决的版本

    

此策略可能会通过应用解决方案规则和自动冲突解决方案来发布在构建期间已解决的版本。这样做的好处是，已发布的版本对应于已测试发布的工件的版本。

解析版本的用例示例：

  * 项目将动态版本用于依赖项，但更喜欢将给定版本的已解析版本公开给其使用者。

  * 与[依赖项锁定](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_locking.html)结合使用，您要发布锁定的版本。

  * 一个项目利用了Gradle的丰富版本约束，这些约束对Ivy进行了有损转换。它不依赖转换，而是发布已解决的版本。

这是通过使用`versionMapping`DSL方法完成的，该方法允许配置[VersionMappingStrategy](file:///Users/dxs/temp/gradle-6.7.1/docs/javadoc/org/gradle/api/publish/VersionMappingStrategy.html)：

例子4.使用解决的版本

`Groovy``Kotlin`

build.gradle

    
    
        publications {
            ivyCustom(IvyPublication) {
                versionMapping {
                    usage('java-api') {
                        fromResolutionOf('runtimeClasspath')
                    }
                    usage('java-runtime') {
                        fromResolutionResult()
                    }
                }
            }
        }

build.gradle.kts

    
    
        publications {
            create<IvyPublication>("ivyCustom") {
                versionMapping {
                    usage("java-api") {
                        fromResolutionOf("runtimeClasspath")
                    }
                    usage("java-runtime") {
                        fromResolutionResult()
                    }
                }
            }
        }

在上面的示例中，Gradle将使用在中`runtimeClasspath`声明的依赖项解析的版本，这些依赖项`api`已映射到`compile`Ivy的配置。Gradle还将使用在上`runtimeClasspath`声明的for依赖项上解析的版本，这些版本`implementation`映射到`runtime`Ivy的配置。
`fromResolutionResult()`指示Gradle应该使用变体`runtimeClasspath`的默认类路径，并且是的默认类路径`java-
runtime`。

##
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#publishing_ivy:repositories)[储存库](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#publishing_ivy:repositories)

该插件提供了[IvyArtifactRepository](file:///Users/dxs/temp/gradle-6.7.1/docs/dsl/org.gradle.api.artifacts.repositories.IvyArtifactRepository.html)类型的[存储库](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_management_terminology.html#sub:terminology_repository)。要了解如何定义和使用存储库进行发布，请参见“[基本发布](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_setup.html#sec:basic_publishing)”部分。[](file:///Users/dxs/temp/gradle-6.7.1/docs/dsl/org.gradle.api.artifacts.repositories.IvyArtifactRepository.html)[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_setup.html#sec:basic_publishing)

这是定义发布存储库的简单示例：

示例5.声明要发布到的存储库

`Groovy``Kotlin`

build.gradle

    
    
    publishing {
        repositories {
            ivy {
                // change to point to your repo, e.g. http://my.org/repo
                url = "$buildDir/repo"
            }
        }
    }

build.gradle.kts

    
    
    publishing {
        repositories {
            ivy {
                // change to point to your repo, e.g. http://my.org/repo
                url = uri("$buildDir/repo")
            }
        }
    }

您将要配置的两个主要内容是存储库：

  * 网址（必填）

  * 名称（可选）

您可以定义多个存储库，只要它们在构建脚本中具有唯一的名称即可。您也可以声明一个（只有一个）没有名称的存储库。该存储库将采用隐式名称“ Ivy”。

您还可以配置连接到存储库所需的任何身份验证详细信息。有关更多详细信息，请参见[IvyArtifactRepository](file:///Users/dxs/temp/gradle-6.7.1/docs/dsl/org.gradle.api.artifacts.repositories.IvyArtifactRepository.html)。

##
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#publishing_ivy:example)[完整的例子](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#publishing_ivy:example)

下面的示例演示了使用多项目构建的发布。每个项目都发布一个Java组件，该Java组件配置为还构建和发布Javadoc和源代码工件。定制描述符文件以包括每个项目的项目描述。

例子6.发布一个Java模块

`Groovy``Kotlin`

settings.gradle

    
    
    rootProject.name = 'ivy-publish-java'
    include 'project1', 'project2'

buildSrc / build.gradle

    
    
    plugins {
        id 'groovy-gradle-plugin'
    }

buildSrc / src / main / groovy / myproject.publishing-conventions.gradle

    
    
    plugins {
        id 'java-library'
        id 'ivy-publish'
    }
    
    version = '1.0'
    group = 'org.gradle.sample'
    
    repositories {
        mavenCentral()
    }
    
    java {
        withJavadocJar()
        withSourcesJar()
    }
    
    publishing {
        repositories {
            ivy {
                // change to point to your repo, e.g. http://my.org/repo
                url = "${rootProject.buildDir}/repo"
            }
        }
        publications {
            ivy(IvyPublication) {
                from components.java
                descriptor.description {
                    text = providers.provider({ description })
                }
            }
        }
    }

project1 / build.gradle

    
    
    plugins {
        id 'myproject.publishing-conventions'
    }
    
    description = 'The first project'
    
    dependencies {
        implementation 'junit:junit:4.13'
        implementation project(':project2')
    }

project2 / build.gradle

    
    
    plugins {
        id 'myproject.publishing-conventions'
    }
    
    description = 'The second project'
    
    dependencies {
        implementation 'commons-collections:commons-collections:3.2.2'
    }

settings.gradle.kts

    
    
    rootProject.name = "ivy-publish-java"
    include("project1", "project2")

buildSrc/build.gradle.kts

    
    
    plugins {
        `kotlin-dsl`
    }
    
    repositories {
        gradlePluginPortal()
    }

buildSrc/src/main/kotlin/myproject.publishing-conventions.gradle.kts

    
    
    plugins {
        id("java-library")
        id("ivy-publish")
    }
    
    version = "1.0"
    group = "org.gradle.sample"
    
    repositories {
        mavenCentral()
    }
    
    java {
        withJavadocJar()
        withSourcesJar()
    }
    
    publishing {
        repositories {
            ivy {
                // change to point to your repo, e.g. http://my.org/repo
                url = uri("${rootProject.buildDir}/repo")
            }
        }
        publications {
            create<IvyPublication>("ivy") {
                from(components["java"])
                descriptor.description {
                    text.set(providers.provider({ description }))
                }
            }
        }
    }

project1/build.gradle.kts

    
    
    plugins {
        id("myproject.publishing-conventions")
    }
    
    description = "The first project"
    
    dependencies {
        implementation("junit:junit:4.13")
        implementation(project(":project2"))
    }

project2/build.gradle.kts

    
    
    plugins {
        id("myproject.publishing-conventions")
    }
    
    description = "The second project"
    
    dependencies {
        implementation("commons-collections:commons-collections:3.2.2")
    }

结果是将为每个项目发布以下工件：

  * Gradle模块元数据文件：`project1-1.0.module`。

  * 常春藤模块元数据文件：`ivy-1.0.xml`。

  * Java组件的主要JAR工件：`project1-1.0.jar`。

  * Javadoc和Java组件的源JAR工件（因为我们配置了`withJavadocJar()`和`withSourcesJar()`）：`project1-1.0-javadoc.jar`，`project1-1.0-source.jar`。

##
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#sec:pub_ivy:legacy_migration)[从旧版Ivy出版物迁移](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#sec:pub_ivy:legacy_migration)

如果要迁移以前依赖于[旧版发布](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/artifact_management.html)支持的项目，则会发现以下两种解决方案之间的差异。

###
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#configurations_marked_as_non_transitive)[标记为不可传递的配置](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#configurations_marked_as_non_transitive)

当配置标记为时`transitive = false`，它不会映射到Ivy。

Gradle将发出警告，指出已发布此类配置。如果确实需要发布此建议，则是使用依赖级别`transitive = false`。

###
[](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#forced_dependencies_are_not_mapped)[强制依赖关系未映射](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#forced_dependencies_are_not_mapped)

虽然Ivy支持[`force`依赖项](https://ant.apache.org/ivy/history/latest-
milestone/ivyfile/dependency.html#_forcing_revision)的概念，但Gradle不会将其已弃用的`force`声明映射到它。

相反，建议将Gradle替换`force`为[`strictly`version](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/rich_versions.html#sec:strict-
version)，以提供[更好的语义](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/dependency_downgrade_and_exclude.html#sec:enforcing_dependency_version)并受Gradle
Module元数据格式支持。

请注意，如果您绝对需要发布强制，则仍然可以[修改产生的`ivy.xml`](file:///Users/dxs/temp/gradle-6.7.1/docs/userguide/publishing_ivy.html#sec:modifying_the_generated_module_descriptor)。

**文件**

  * [用户手册](file:///userguide/userguide.html)
  * [DSL参考](file:///dsl/)
  * [发行说明](file:///release-notes.html)
  * [Java文档](file:///javadoc/)

**新闻**

  * [博客](https://blog.gradle.org/)
  * [通讯](https://newsletter.gradle.com/)
  * [推特](https://twitter.com/gradle)
  * [状态页](https://status.gradle.com/)

**产品展示**

  * [构建扫描](https://gradle.com/build-scans/)
  * [构建缓存](https://gradle.com/build-cache/)
  * [企业文件](https://gradle.com/enterprise/resources/)

**得到帮助**

  * [论坛](https://discuss.gradle.org/c/help-discuss)
  * [的GitHub](https://github.com/gradle/)
  * [训练](https://gradle.com/training/)
  * [服务](https://gradle.org/services/)

##### 随时`UP-TO-DATE`关注新功能和新闻

输入您的电子邮件，即表示您同意我们的[条款](https://gradle.com/legal/terms-of-
service/)和[隐私政策](https://gradle.com/legal/privacy/)，包括接收电子邮件。您可以随时取消订阅。

订阅

© [Gradle Inc.](https://gradle.com/) 2020年 版权所有。

[ gradle ](file:///)

[招贤纳士](https://gradle.com/careers/)| [隐私](https://gradle.com/legal/privacy/)|
[服务条款](https://gradle.com/legal/terms-of-service/)|
[联系](https://gradle.org/contact/)

![Google 翻译](./常春藤发布插件_files/translate_24dp.png)

# 原文

提供更好的翻译建议

* * *

