 无标题 <style id="wiz_custom_css">html, .wiz-editor-body {font-size: 12pt;}.wiz-editor-body {font-family: Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;line-height: 1.7;margin: 0 auto;position:relative;padding: 20px 16px;}.wiz-editor-body h1,.wiz-editor-body h2,.wiz-editor-body h3,.wiz-editor-body h4,.wiz-editor-body h5,.wiz-editor-body h6 {margin:20px 0 10px;margin:1.25rem 0 0.625rem;padding: 0;font-weight: bold;}.wiz-editor-body h1 {font-size:20pt;font-size:1.67rem;}.wiz-editor-body h2 {font-size:18pt;font-size:1.5rem;}.wiz-editor-body h3 {font-size:15pt;font-size:1.25rem;}.wiz-editor-body h4 {font-size:14pt;font-size:1.17rem;}.wiz-editor-body h5 {font-size:12pt;font-size:1rem;}.wiz-editor-body h6 {font-size:12pt;font-size:1rem;color: #777777;margin: 1rem 0;}.wiz-editor-body div,.wiz-editor-body p,.wiz-editor-body ul,.wiz-editor-body ol,.wiz-editor-body dl,.wiz-editor-body li {margin:8px 0 0;}.wiz-editor-body blockquote,.wiz-editor-body table,.wiz-editor-body pre,.wiz-editor-body code {margin:8px 0;}.wiz-editor-body .CodeMirror pre {margin:0;}.wiz-editor-body a {word-wrap: break-word;text-decoration-skip-ink: none;}.wiz-editor-body ul,.wiz-editor-body ol {padding-left:32px;padding-left:2rem;}.wiz-editor-body ol.wiz-list-level1 > li {list-style-type:decimal;}.wiz-editor-body ol.wiz-list-level2 > li {list-style-type:lower-latin;}.wiz-editor-body ol.wiz-list-level3 > li {list-style-type:lower-roman;}.wiz-editor-body li.wiz-list-align-style {list-style-position: inside; margin-left: -1em;}.wiz-editor-body blockquote {padding: 0 12px;}.wiz-editor-body blockquote > :first-child {margin-top:0;}.wiz-editor-body blockquote > :last-child {margin-bottom:0;}.wiz-editor-body img {border:0;max-width:100%;height:auto !important;margin:2px 0;padding: 2px;vertical-align:bottom;}.wiz-editor-body table {border-collapse:collapse;border:1px solid #a7afbc;}.wiz-editor-body td,.wiz-editor-body th {padding:4px 8px;border-collapse:collapse;border:1px solid #a7afbc;min-height:28px;word-break:break-word;box-sizing: border-box;}.wiz-editor-body td > div:first-child {margin-top:0;}.wiz-editor-body td > div:last-child {margin-bottom:0;}.wiz-editor-body img.wiz-svg-image {box-shadow:1px 1px 4px #E8E8E8;}.wiz-editor-body .wiz-image-container {margin:0;max-width: 100%;display: inline-flex;flex-direction: column;}.wiz-editor-body .wiz-image-container .wiz-image-title {display:inline-block;text-align: center;color: #a7afbc;line-height: 18px;font-size: 12px;min-height: 18px;width: 100%;white-space: normal;}.wiz-hide {display:none !important;}.wiz-editor-body.wiz-editor-outline {padding-right:0; padding-left:0;}.wiz-editor-body.wiz-editor-outline .outline-container {margin:0; padding:0; line-height:1.5;}.wiz-editor-body.wiz-editor-outline .outline-container div {margin:0;}.wiz-editor-body.wiz-editor-outline .node {margin:0; padding: 0;}.wiz-editor-body.wiz-editor-outline .outline-container > .node {margin-right:24px; margin-left:30px;}.wiz-editor-body.wiz-editor-outline .node.collapsed .children {display:none;}.wiz-editor-body.wiz-editor-outline .node .row {position:relative; padding-left:26px;}.wiz-editor-body.wiz-editor-outline .node .operator-container {width:36px;position:absolute; top:4px; left:-18px;}.wiz-editor-body.wiz-editor-outline .node .operator-bar {position:absolute; top:0; left:0; right:0; bottom:0; display:flex; align-items:center; justify-content:center;}.wiz-editor-body.wiz-editor-outline .node .switch {width:18px; height:18px;display:flex;flex-direction: column;align-items: center;overflow: hidden;}.wiz-editor-body.wiz-editor-outline .node .switch i {font-size:20px;position:relative;left:-1px;top:-1px;}.wiz-editor-body.wiz-editor-outline .node .switch.active {cursor:pointer;color:transparent; transition:transform 200ms ease 0s;}.wiz-editor-body.wiz-editor-outline .node.collapsed .switch.active {transform:rotateZ(-90deg);}.wiz-editor-body.wiz-editor-outline .node .row:hover .switch.active {color:#505F79}.wiz-editor-body.wiz-editor-outline .node .dot {display:flex; align-items:center; justify-content:center; border-radius:100%; width:18px; height:18px;}.wiz-editor-body.wiz-editor-outline .node.collapsed .dot {background-color:rgba(80, 95, 121, .15);}.wiz-editor-body.wiz-editor-outline .node .dot-icon {background-color:#505F79; border-radius:100%; width:6px; height:6px;}.wiz-editor-body.wiz-editor-outline .node .child {margin-left:8px; border-left:1px solid #E6E9ED; padding-left:17px;}.wiz-editor-body.wiz-editor-outline .node .content {flex:1;outline:none; padding:4px 0;}.wiz-editor-body.wiz-editor-outline .node div.content {font-size:1rem;}.wiz-editor-body.wiz-editor-outline .node.complete > .row .content {text-decoration:line-through;color:#A7AFBC;}.wiz-editor-body.wiz-editor-outline .node .notes {outline:none; font-size:.8rem; color:#A7AFBC;}.wiz-editor-body.wiz-editor-outline .node .image {outline:none; padding-top:4px; padding-bottom:4px;}.wiz-editor-body.wiz-editor-outline .outline-container h1,.wiz-editor-body.wiz-editor-outline .outline-container h2,.wiz-editor-body.wiz-editor-outline .outline-container h3,.wiz-editor-body.wiz-editor-outline .outline-container h4,.wiz-editor-body.wiz-editor-outline .outline-container h5,.wiz-editor-body.wiz-editor-outline .outline-container h6 {margin:0;}body, .wiz-editor-body { padding-left: 48px; padding-right: 48px;}</style><style id="wiz_code_style">.wiz-editor-body .wiz-code-container{position: relative; padding:8px 0; margin: 5px 0;text-indent:0; text-align:left;}.CodeMirror {font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace; color: black; font-size: 10.5pt; font-size: 0.875rem}.wiz-editor-body .wiz-code-container .CodeMirror div {margin-top: 0; margin-bottom: 0;}.CodeMirror-lines {padding: 4px 0;}.CodeMirror pre.CodeMirror-line,.CodeMirror pre.CodeMirror-line-like {padding: 0 4px;}.CodeMirror pre.CodeMirror-line {min-height: 24px;}.CodeMirror-scrollbar-filler, .CodeMirror-gutter-filler {background-color: white;}.CodeMirror-gutters {border-right: 1px solid #ddd; background-color: #f7f7f7; white-space: nowrap;}.CodeMirror-linenumbers {}.CodeMirror-linenumber {padding: 0 3px 0 5px; min-width: 20px; text-align: right; color: #999; white-space: nowrap;}.CodeMirror-guttermarker {color: black;}.CodeMirror-guttermarker-subtle {color: #999;}.CodeMirror-cursor {border-left: 1px solid black; border-right: none; width: 0;}.CodeMirror div.CodeMirror-secondarycursor {border-left: 1px solid silver;}.cm-fat-cursor .CodeMirror-cursor {width: auto; border: 0 !important; background: #7e7;}.cm-fat-cursor div.CodeMirror-cursors {z-index: 1;}.cm-fat-cursor-mark {background-color: rgba(20, 255, 20, 0.5);-webkit-animation: blink 1.06s steps(1) infinite;-moz-animation: blink 1.06s steps(1) infinite;animation: blink 1.06s steps(1) infinite;}.cm-animate-fat-cursor {width: auto; border: 0; -webkit-animation: blink 1.06s steps(1) infinite; -moz-animation: blink 1.06s steps(1) infinite; animation: blink 1.06s steps(1) infinite; background-color: #7e7;}@-moz-keyframes blink { 0% {} 50% { background-color: transparent; } 100% {}}@-webkit-keyframes blink { 0% {} 50% { background-color: transparent; } 100% {}}@keyframes blink { 0% {} 50% { background-color: transparent; } 100% {}}.CodeMirror-overwrite .CodeMirror-cursor {}.cm-tab { display: inline-block; text-decoration: inherit; }.CodeMirror-rulers {position: absolute; left: 0; right: 0; top: -50px; bottom: -20px; overflow: hidden;}.CodeMirror-ruler {border-left: 1px solid #ccc; top: 0; bottom: 0; position: absolute;}.cm-s-default .cm-header {color: blue;}.cm-s-default .cm-quote {color: #090;}.cm-negative {color: #d44;}.cm-positive {color: #292;}.cm-header, .cm-strong {font-weight: bold;}.cm-em {font-style: italic;}.cm-link {text-decoration: underline;}.cm-strikethrough {text-decoration: line-through;}.cm-s-default .cm-keyword {color: #708;}.cm-s-default .cm-atom {color: #219;}.cm-s-default .cm-number {color: #164;}.cm-s-default .cm-def {color: #00f;}.cm-s-default .cm-variable,.cm-s-default .cm-punctuation,.cm-s-default .cm-property,.cm-s-default .cm-operator {}.cm-s-default .cm-variable-2 {color: #05a;}.cm-s-default .cm-variable-3 {color: #085;}.cm-s-default .cm-comment {color: #a50;}.cm-s-default .cm-string {color: #a11;}.cm-s-default .cm-string-2 {color: #f50;}.cm-s-default .cm-meta {color: #555;}.cm-s-default .cm-qualifier {color: #555;}.cm-s-default .cm-builtin {color: #30a;}.cm-s-default .cm-bracket {color: #997;}.cm-s-default .cm-tag {color: #170;}.cm-s-default .cm-attribute {color: #00c;}.cm-s-default .cm-hr {color: #999;}.cm-s-default .cm-link {color: #00c;}.cm-s-default .cm-error {color: #f00;}.cm-invalidchar {color: #f00;}.CodeMirror-composing { border-bottom: 2px solid; }div.CodeMirror span.CodeMirror-matchingbracket {color: #0b0;}div.CodeMirror span.CodeMirror-nonmatchingbracket {color: #a22;}.CodeMirror-matchingtag { background: rgba(255, 150, 0, .3); }.CodeMirror-activeline-background {background: #e8f2ff;}.CodeMirror {position: relative; background: #f5f5f5;}.CodeMirror-scroll {overflow: hidden !important; margin-bottom: 0; margin-right: -30px; padding: 16px 30px 16px 0; outline: none; position: relative;}.CodeMirror-sizer {position: relative; border-right: 30px solid transparent;}.CodeMirror-vscrollbar, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-gutter-filler {position: absolute; z-index: 6; display: none;}.CodeMirror-vscrollbar {right: 0; top: 0; overflow-x: hidden; overflow-y: scroll;}.CodeMirror-hscrollbar {bottom: 0; left: 0 !important; overflow-y: hidden; overflow-x: scroll;pointer-events: auto !important;outline: none;}.CodeMirror-scrollbar-filler {right: 0; bottom: 0;}.CodeMirror-gutter-filler {left: 0; bottom: 0;}.CodeMirror-gutters {position: absolute; left: 0; top: 0; min-height: 100%; z-index: 3;}.CodeMirror-gutter {white-space: normal; height: 100%; display: inline-block; vertical-align: top; margin-bottom: -30px;}.CodeMirror-gutter-wrapper {position: absolute; z-index: 4; background: none !important; border: none !important;}.CodeMirror-gutter-background {position: absolute; top: 0; bottom: 0; z-index: 4;}.CodeMirror-gutter-elt {position: absolute; cursor: default; z-index: 4;}.CodeMirror-gutter-wrapper ::selection { background-color: transparent }.CodeMirror-gutter-wrapper ::-moz-selection { background-color: transparent }.CodeMirror-lines {cursor: text; min-height: 1px;}.CodeMirror pre.CodeMirror-line,.CodeMirror pre.CodeMirror-line-like {-moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0; border-width: 0; background: transparent; font-family: inherit; font-size: inherit; margin: 0; white-space: pre; word-wrap: normal; line-height: inherit; color: inherit; z-index: 2; position: relative; overflow: visible; -webkit-tap-highlight-color: transparent; -webkit-font-variant-ligatures: contextual; font-variant-ligatures: contextual;}.CodeMirror-wrap pre.CodeMirror-line,.CodeMirror-wrap pre.CodeMirror-line-like {word-wrap: break-word; white-space: pre-wrap; word-break: normal;}.CodeMirror-linebackground {position: absolute; left: 0; right: 0; top: 0; bottom: 0; z-index: 0;}.CodeMirror-linewidget {position: relative; z-index: 2; padding: 0.1px;}.CodeMirror-widget {}.CodeMirror-rtl pre { direction: rtl; }.CodeMirror-code {outline: none;}.CodeMirror-scroll,.CodeMirror-sizer,.CodeMirror-gutter,.CodeMirror-gutters,.CodeMirror-linenumber {-moz-box-sizing: content-box; box-sizing: content-box;}.CodeMirror-measure {position: absolute; width: 100%; height: 0; overflow: hidden; visibility: hidden;}.CodeMirror-cursor {position: absolute; pointer-events: none;}.CodeMirror-measure pre { position: static; }div.CodeMirror-cursors {visibility: hidden; position: relative; z-index: 3;}div.CodeMirror-dragcursors {visibility: visible;}.CodeMirror-focused div.CodeMirror-cursors {visibility: visible;}.CodeMirror-selected { background: #d9d9d9; }.CodeMirror-focused .CodeMirror-selected { background: #d7d4f0; }.CodeMirror-crosshair { cursor: crosshair; }.CodeMirror-line::selection, .CodeMirror-line > span::selection, .CodeMirror-line > span > span::selection { background: #d7d4f0; }.CodeMirror-line::-moz-selection, .CodeMirror-line > span::-moz-selection, .CodeMirror-line > span > span::-moz-selection { background: #d7d4f0; }.cm-searching {background: #ffa; background: rgba(255, 255, 0, .4);}.cm-force-border { padding-right: .1px; }@media print { .CodeMirror div.CodeMirror-cursors {visibility: hidden;}}.cm-tab-wrap-hack:after { content: ""; }span.CodeMirror-selectedtext { background: none; }.CodeMirror-activeline-background, .CodeMirror-selected {transition: visibility 0ms 100ms;}.CodeMirror-blur .CodeMirror-activeline-background, .CodeMirror-blur .CodeMirror-selected {visibility:hidden;}.CodeMirror-blur .CodeMirror-matchingbracket {color:inherit !important;outline:none !important;text-decoration:none !important;}.CodeMirror-sizer {min-height:auto !important;}</style>

# 摇篮包装

内容

* [添加Gradle包装器](#sec:adding_wrapper)
* [使用Gradle包装器](#sec:using_wrapper)
* [升级Gradle包装器](#sec:upgrading_wrapper)
* [自定义Gradle包装器](#customizing_wrapper)
* [验证Gradle Wrapper JAR的完整性](#wrapper_checksum_verification)

建议执行任何Gradle构建的方法是在Gradle Wrapper（简称为“ Wrapper”）的帮助下。包装器是一个脚本，可调用Gradle的声明版本，并在必要时预先下载。因此，开发人员可以快速启动并运行Gradle项目，而无需遵循手动安装过程，从而节省了公司的时间和金钱。

图1.包装器工作流程

**简而言之，您将获得以下好处：**

* 在给定的Gradle版本上标准化项目，从而实现更可靠，更可靠的构建。
* 向不同的用户和执行环境（例如IDE或Continuous Integration服务器）提供新的Gradle版本就像更改包装器定义一样简单。

**那么它是怎样工作的？对于用户而言，通常有三种不同的工作流程：**

* 您设置了一个新的Gradle项目，并希望[将包装器添加](#sec:adding_wrapper)到其中。
* 您想[使用](#sec:using_wrapper)已经提供[了包装](#sec:using_wrapper)程序[的项目](#sec:using_wrapper)来[运行该项目](#sec:using_wrapper)。
* 您想[将包装器升级](#sec:upgrading_wrapper)到新版本的Gradle。

以下各节将更详细地说明这些用例。

## [](#sec:adding_wrapper)[添加Gradle包装器](#sec:adding_wrapper)

生成Wrapper文件需要在计算机上安装Gradle运行时的安装版本，如[Installation中所述]()。幸运的是，生成初始Wrapper文件是一个一次性的过程。

每个普通的Gradle构建都带有一个称为的内置任务`wrapper`。列出任务时，您将可以在“构建安装程序任务”组下找到列出[的任务]()。执行`wrapper`任务会在项目目录中生成必要的Wrapper文件。

运行包装器任务

\$ gradle包装 >任务：包装
 在0秒内成功建立 1个可执行的任务：1个已执行

<table style="background:none;width:912px;"><tbody><tr><td class="icon" style="color:rgba(0, 0, 0, 0.8);width:80px;"><i class="fa icon-note"></i></td><td class="content" style="font-size:1.0625rem;color:rgba(0, 0, 0, 0.6);"><div class="paragraph"><p style="font-size: 1rem;"><font><font>要使包装器文件可用于其他开发人员和执行环境，您需要将其检入版本控制。</font><font>包括JAR文件在内的所有包装程序文件都非常小。</font><font>期望将JAR文件添加到版本控制中。</font><font>一些组织不允许项目将二进制文件提交给版本控制。</font><font>目前，该方法没有其他选择。</font></font></p></div></td></tr></tbody></table>

生成的Wrapper属性文件，`gradle/wrapper/gradle-wrapper.properties`存储有关Gradle分布的信息。

* 托管Gradle发行版的服务器。
* Gradle分布的类型。默认情况下，该`-bin`发行版仅包含运行时，但不包含示例代码和文档。
* 用于执行构建的Gradle版本。默认情况下，`wrapper`任务会选择与用于生成包装器文件的Gradle版本完全相同的Gradle版本。

`gradle/wrapper/gradle-wrapper.properties`

distributionUrl=https\\://services.gradle.org/distributions/gradle-6.7.1-bin.zip

 

1

distributionUrl\=https\\://services.gradle.org/distributions/gradle-6.7.1-bin.zip

所有这些方面都可以在以下命令行选项的帮助下配置包装器文件时进行配置。

`--gradle-version`

用于下载和执行包装程序的Gradle版本。

`--distribution-type`

包装器使用的Gradle分布类型。可用的选项是`bin`和`all`。默认值为`bin`。

`--gradle-distribution-url`

指向Gradle分发ZIP文件的完整URL。使用此选项，`--gradle-version`并且`--distribution-type`过时的网址已经包含此信息。如果您想在公司网络内部托管Gradle发行版，则此选项非常有价值。

`--gradle-distribution-sha256-sum`

SHA256哈希和用于[验证下载的Gradle分布](#sec:verification)。

让我们假设以下用例说明了命令行选项的用法。您想生成版本为6.7.1的Wrapper，并使用该`-all`发行版来使您的IDE启用代码补全功能并能够导航到Gradle源代码。这些要求由以下命令行执行捕获：

提供包装任务的选项

\$ gradle wrapper --gradle-version 6.7.1 --distribution-type全部 >任务：包装
 在0秒内成功建立 1个可执行的任务：1个已执行

结果，您可以在包装器属性文件中找到所需的信息。

示例：生成的分发URL

distributionUrl=https\\://services.gradle.org/distributions/gradle-6.7.1-all.zip

 

1

distributionUrl\=https\\://services.gradle.org/distributions/gradle-6.7.1-all.zip

让我们看一下以下项目布局，以说明预期的Wrapper文件：

`Groovy``Kotlin`

. ├── a-subproject │ └── build.gradle ├── settings.gradle ├── gradle │ └── wrapper │ ├── gradle-wrapper.jar │ └── gradle-wrapper.properties ├── gradlew └── gradlew.bat

 

1

.

2

├── a\-subproject

3

│   └── build.gradle

4

├── settings.gradle

5

├── gradle

6

│   └── wrapper

7

│       ├── gradle\-wrapper.jar

8

│       └── gradle\-wrapper.properties

9

├── gradlew

10

└── gradlew.bat

Gradle项目通常为每个子项目提供一个`settings.gradle(.kts)`文件和一个`build.gradle(.kts)`文件。包装程序文件位于项目的`gradle`目录和根目录中。以下列表说明了它们的用途。

`gradle-wrapper.jar`

包装JAR文件，其中包含用于下载Gradle发行版的代码。

`gradle-wrapper.properties`

一个属性文件，负责配置Wrapper运行时行为，例如与该版本兼容的Gradle版本。请注意，更多常规设置（例如，[将包装器配置为使用代理]()）需要进入[其他文件]()。

`gradlew`，`gradlew.bat`

一个外壳脚本和一个Windows批处理脚本，用于使用包装程序执行构建。

您可以继续[使用包装程序执行构建，](#sec:using_wrapper)而不必安装Gradle运行时。如果您正在处理的项目不包含那些Wrapper文件，则需要[生成它们](#sec:adding_wrapper)。

## [](#sec:using_wrapper)[使用Gradle包装器](#sec:using_wrapper)

建议始终使用包装程序执行构建，以确保可靠，受控和标准化地执行构建。使用Wrapper看起来几乎就像使用Gradle安装来运行构建。根据操作系统的不同，您可以运行`gradlew`或`gradlew.bat`代替`gradle`命令。以下控制台输出演示了Windows机器上包装程序对基于Java的项目的使用。

使用包装程序批处理文件执行构建

\$ gradlew.bat构建 正在下载https://services.gradle.org/distributions/gradle-5.0-all.zip ................................................... .................................... 将C：\\ Documents and Settings \\ Claudia \\ .gradle \\ wrapper \\ dists \\ gradle-5.0-all \\ ac27o8rbd0ic8ih41or9l32mv \\ gradle-5.0-all.zip解压缩到C：\\ Documents and Settings \\ Claudia \\ .gradle \\ wrapper \\ dists \\ gradle -5.0-al \\ ac27o8rbd0ic8ih41or9l32mv 设置以下文件的可执行权限：C：\\ Documents and Settings \\ Claudia \\ .gradle \\ wrapper \\ dists \\ gradle-5.0-all \\ ac27o8rbd0ic8ih41or9l32mv \\ gradle-5.0 \\ bin \\ gradle
 在12秒内成功建立 1个可执行的任务：1个已执行

如果Gradle发行版在计算机上不可用，包装程序将下载它并存储在本地文件系统中。只要Gradle属性中的分发URL不变，任何后续的构建调用都将重用现有的本地分发。

<table style="background:none;width:912px;"><tbody><tr><td class="icon" style="color:rgba(0, 0, 0, 0.8);width:80px;"><i class="fa icon-note"></i></td><td class="content" style="font-size:1.0625rem;color:rgba(0, 0, 0, 0.6);"><div class="paragraph"><p style="font-size: 1rem;"><font><font>包装程序外壳程序脚本和批处理文件位于单项目或多项目Gradle构建的根目录中。</font><font>如果要从子项目目录执行构建，则需要引用这些文件的正确路径</font></font><code style="font-family:Inconsolata, monospace;font-size:0.9375rem;color:rgba(0, 0, 0, 0.9);background-color:rgb(247, 247, 248);">../../gradlew tasks</code><font><font>。</font></font></p></div></td></tr></tbody></table>

## [](#sec:upgrading_wrapper)[升级Gradle包装器](#sec:upgrading_wrapper)

项目通常会希望与时俱进并升级Gradle版本，以从新功能和改进中受益。升级Gradle版本的一种方法是手动更改`distributionUrl`包装器`gradle-wrapper.properties`文件中的属性。更好的建议选项是运行`wrapper`任务并提供目标Gradle版本，如[添加Gradle包装器中所述](#sec:adding_wrapper)。使用该`wrapper`任务可确保对具有该特定Gradle版本的Wrapper Shell脚本或批处理文件所做的任何优化都应用于项目。与往常一样，您应该将对Wrapper文件的更改提交给版本控制。

请注意，仅运行一次包装程序任务将`gradle-wrapper.properties`仅更新，但`gradle-wrapper.jar`不影响包装程序本身。这通常很好，因为即使使用古老的包装文件也可以运行Gradle的新版本。但是，如果您希望**所有**包装器文件都是最新的，则需要再次运行该`wrapper`任务。

使用Gradle`wrapper`任务生成包装器，指定版本。默认为当前版本。升级包装程序后，可以通过执行来检查它是否是您期望的版本`./gradlew \--version`。

示例：升级包装器版本

\$ ./gradlew包装器--gradle-version 6.7.1
 在4秒钟内成功建立 1个可执行的任务：1个已执行

## [](#customizing_wrapper)[自定义Gradle包装器](#customizing_wrapper)

Gradle的大多数用户对Wrapper的默认运行时行为感到满意。但是，组织策略，安全性约束或个人喜好可能需要您更深入地定制包装器。幸运的是，内置`wrapper`任务提供了许多选项，可以使运行时行为适应您的需求。大多数配置选项由基础任务类型[Wrapper]()公开。

假设您`-all`每次升级包装程序时都厌倦了在命令行上定义分发类型。您可以通过重新配置`wrapper`任务来节省一些键盘笔触。

示例1.定制包装器任务

`Groovy``Kotlin`

build.gradle

tasks.named\('wrapper'\) \{ distributionType = Wrapper.DistributionType.ALL \}

 

1

tasks.named\('wrapper'\) \{

2

 distributionType \= Wrapper.DistributionType.ALL

3

\}

在适当的配置下，运行`./gradlew wrapper \--gradle-version 6.7.1`足以`distributionUrl`在Wrapper属性文件中生成一个值，该值将请求`-all`分发。

生成的分发URL

distributionUrl = https \\：//services.gradle.org/distributions/gradle-6.7.1-all.zip

请查阅API文档，以获取有关可用配置选项的更多详细说明。您还可以在Gradle发行版中找到用于配置包装器的各种示例。

### [](#sec:authenticated_download)[经过身份验证的Gradle发行版下载](#sec:authenticated_download)

Gradle`Wrapper`可以使用HTTP基本身份验证从服务器下载Gradle发行版。这使您可以将Gradle分发托管在受保护的私有服务器上。您可以根据使用情况以两种不同的方式指定用户名和密码：作为系统属性或直接嵌入`distributionUrl`。系统属性中的凭据优先于嵌入的凭据`distributionUrl`。

<table style="background:none;width:912px;"><tbody><tr><td class="icon" style="color:rgba(0, 0, 0, 0.8);width:80px;"><i class="fa icon-tip"></i></td><td class="content" style="font-size:1.0625rem;color:rgba(0, 0, 0, 0.6);"><div class="title" style="color:rgb(85, 85, 85);font-size:1.25rem;"><font><font>安全警告</font></font></div><div class="paragraph"><p style="font-size: 1rem;"><font><font>HTTP基本身份验证仅应与</font></font><code style="font-family:Inconsolata, monospace;font-size:0.9375rem;color:rgba(0, 0, 0, 0.9);background-color:rgb(247, 247, 248);">HTTPS</code><font><font>URL</font><font>一起使用，</font><font>而不应与普通URL</font><font>一起使用</font></font><code style="font-family:Inconsolata, monospace;font-size:0.9375rem;color:rgba(0, 0, 0, 0.9);background-color:rgb(247, 247, 248);">HTTP</code><font><font>。</font><font>使用基本身份验证，用户凭据以明文形式发送。</font></font></p></div></td></tr></tbody></table>

使用系统属性可以`.gradle/gradle.properties`在用户主目录中的文件中完成，也可以通过其他方式进行，请参阅[Gradle配置属性]()。

使用系统属性指定HTTP基本身份验证凭据

systemProp.gradle.wrapperUser=username systemProp.gradle.wrapperPassword=password

 

1

systemProp.gradle.wrapperUser\=username

2

systemProp.gradle.wrapperPassword\=password

嵌入在证书`distributionUrl`中`gradle/wrapper/gradle-wrapper.properties`的文件也适用。请注意，该文件将提交到您的源代码管理系统中。嵌入的共享凭据`distributionUrl`仅应在受控环境中使用。

在中指定HTTP基本身份验证凭据`distributionUrl`

distributionUrl = https：//用户名：password\@somehost/path/to/gradle-distribution.zip

可以与已认证的代理或未认证的代理一起使用。有关如何配置使用[代理]()的更多信息，请参见[通过代理访问网络]()`Wrapper`。

### [](#sec:verification)[验证下载的Gradle发行版](#sec:verification)

Gradle包装器可通过SHA-256哈希总和比较来验证下载的Gradle分发。通过防止中间人攻击者篡改下载的Gradle发行版，提高了针对目标攻击的安全性。

要启用此功能，请下载`.sha256`与要验证的Gradle发行版关联的文件。

#### [](#downloading_the_sha_256_file)[下载SHA-256文件](#downloading_the_sha_256_file)

您可以`.sha256`从[稳定发行版](https://services.gradle.org/distributions/)或[候选](https://services.gradle.org/distributions-snapshots/)[发行](https://services.gradle.org/distributions/)[版和每晚发行版中](https://services.gradle.org/distributions-snapshots/)下载文件。文件的格式是一行文本，它是相应zip文件的SHA-256哈希。

您还可以参考[Gradle分布校验和列表](https://gradle.org/release-checksums/)。

#### [](#configuring_checksum_verification)[配置校验和验证](#configuring_checksum_verification)

将下载的哈希值添加到`gradle-wrapper.properties`使用`distributionSha256Sum`属性或`--gradle-distribution-sha256-sum`在命令行上使用。

配置SHA-256校验和验证

distributionSha256Sum=371cb9fbebbe9880d147f59bab36d61eee122854ef8c9ee1ecf12b82368bcf10

 

1

distributionSha256Sum\=371cb9fbebbe9880d147f59bab36d61eee122854ef8c9ee1ecf12b82368bcf10

如果配置的校验和与在托管发行版的服务器上找到的校验和不匹配，则Gradle将报告构建失败。仅当尚未下载已配置的包装器分发程序时才执行校验和验证。

## [](#wrapper_checksum_verification)[验证Gradle Wrapper JAR的完整性](#wrapper_checksum_verification)

包装JAR是一个二进制文件，将在开发人员和构建服务器的计算机上执行。与所有此类文件一样，在执行文件之前，应确保它是可信任的。由于通常将Wrapper JAR检查到项目的版本控制系统中，恶意参与者有可能通过提交貌似仅升级Gradle版本的拉取请求来用修改后的JAR替换原始JAR。

为了验证包装JAR的完整性，Gradle创建了一个[GitHub Action](https://github.com/marketplace/actions/gradle-wrapper-validation)，该[GitHub Action](https://github.com/marketplace/actions/gradle-wrapper-validation)根据已知的良好校验和列表自动检查请求请求中的包装JAR。Gradle还会发布[所有发行版](https://gradle.org/release-checksums/)的[校验和](https://gradle.org/release-checksums/)（3.3至4.0.2版除外，该版本不会生成可复制的JAR），因此您可以手动验证包装JAR的完整性。

### [](#automatically_verifying_the_gradle_wrapper_jar_on_github)[在GitHub上自动验证Gradle Wrapper JAR](#automatically_verifying_the_gradle_wrapper_jar_on_github)

在[GitHub的行动](https://github.com/marketplace/actions/gradle-wrapper-validation)是从摇篮单独发布，所以请检查其如何将其应用到你的项目文档。

### [](#manually_verifying_the_gradle_wrapper_jar)[手动验证Gradle Wrapper JAR](#manually_verifying_the_gradle_wrapper_jar)

您可以通过在主要操作系统之一上运行以下命令来手动验证Wrapper JAR的校验和，以确保未被篡改：

在Linux上手动验证Wrapper JAR的校验和

\$ cd gradle/wrapper \$ curl --location --output gradle-wrapper.jar.sha256 \\ https://services.gradle.org/distributions/gradle-6.7.1-wrapper.jar.sha256 \$ echo " gradle-wrapper.jar" >> gradle-wrapper.jar.sha256 \$ sha256sum --check gradle-wrapper.jar.sha256 gradle-wrapper.jar: OK

 

1

\$ cd gradle/wrapper

2

\$ curl \--location \--output gradle\-wrapper.jar.sha256 \\

3

 https://services.gradle.org/distributions/gradle-6.7.1-wrapper.jar.sha256

4

\$ echo "  gradle-wrapper.jar" \>> gradle\-wrapper.jar.sha256

5

\$ sha256sum \--check gradle\-wrapper.jar.sha256

6

gradle\-wrapper.jar: OK

在macOS上手动验证Wrapper JAR的校验和

\$ cd gradle/wrapper \$ curl --location --output gradle-wrapper.jar.sha256 \\ https://services.gradle.org/distributions/gradle-6.7.1-wrapper.jar.sha256 \$ echo " gradle-wrapper.jar" >> gradle-wrapper.jar.sha256 \$ shasum --check gradle-wrapper.jar.sha256 gradle-wrapper.jar: OK

 

1

\$ cd gradle/wrapper

2

\$ curl \--location \--output gradle\-wrapper.jar.sha256 \\

3

 https://services.gradle.org/distributions/gradle-6.7.1-wrapper.jar.sha256

4

\$ echo "  gradle-wrapper.jar" \>> gradle\-wrapper.jar.sha256

5

\$ shasum \--check gradle\-wrapper.jar.sha256

6

gradle\-wrapper.jar: OK

在Windows上手动验证Wrapper JAR的校验和（使用PowerShell）

\> \$expected = Invoke-RestMethod -Uri https://services.gradle.org/distributions/gradle-6.7.1-wrapper.jar.sha256 > \$actual = \(Get-FileHash gradle\\wrapper\\gradle-wrapper.jar -Algorithm SHA256\).Hash.ToLower\(\) > \@\{\$true = 'OK: Checksum match'; \$false = "ERROR: Checksum mismatch\!\`nExpected: \$expected\`nActual: \$actual"\}\[\$actual -eq \$expected\] OK: Checksum match

 

1

\> \$expected \= Invoke\-RestMethod \-Uri https://services.gradle.org/distributions/gradle-6.7.1-wrapper.jar.sha256

2

\> \$actual \= \(Get\-FileHash gradle\\wrapper\\gradle\-wrapper.jar \-Algorithm SHA256\).Hash.ToLower\(\)

3

\> \@\{\$true \= 'OK: Checksum match'; \$false \= "ERROR: Checksum mismatch\!\`nExpected: \$expected\`nActual:   \$actual"\}\[\$actual \-eq \$expected\]

4

OK: Checksum match

### [](#troubleshooting_a_checksum_mismatch)[对校验和不匹配进行故障排除](#troubleshooting_a_checksum_mismatch)

如果校验和与您期望的校验和不匹配，则可能是`wrapper`升级的Gradle发行版未执行任务。因此，您应该首先检查实际校验和是否与其他Gradle版本之一匹配。您可以在主要操作系统上运行以下命令来生成Wrapper JAR的实际校验和：

在Linux上生成包装器JAR的实际校验和

\$ sha256sum gradle/wrapper/gradle-wrapper.jar d81e0f23ade952b35e55333dd5f1821585e887c6d24305aeea2fbc8dad564b95 gradle/wrapper/gradle-wrapper.jar

 

1

\$ sha256sum gradle/wrapper/gradle\-wrapper.jar

2

d81e0f23ade952b35e55333dd5f1821585e887c6d24305aeea2fbc8dad564b95  gradle/wrapper/gradle\-wrapper.jar

在macOS上生成包装器JAR的实际校验和

\$ shasum --algorithm=256 gradle/wrapper/gradle-wrapper.jar d81e0f23ade952b35e55333dd5f1821585e887c6d24305aeea2fbc8dad564b95 gradle/wrapper/gradle-wrapper.jar

 

1

\$ shasum \--algorithm\=256 gradle/wrapper/gradle\-wrapper.jar

2

d81e0f23ade952b35e55333dd5f1821585e887c6d24305aeea2fbc8dad564b95  gradle/wrapper/gradle\-wrapper.jar

在Windows上生成包装器JAR的实际校验和（使用PowerShell）

\> \(Get-FileHash gradle\\wrapper\\gradle-wrapper.jar -Algorithm SHA256\).Hash.ToLower\(\) d81e0f23ade952b35e55333dd5f1821585e887c6d24305aeea2fbc8dad564b95

 

1

\> \(Get\-FileHash gradle\\wrapper\\gradle\-wrapper.jar \-Algorithm SHA256\).Hash.ToLower\(\)

2

d81e0f23ade952b35e55333dd5f1821585e887c6d24305aeea2fbc8dad564b95

一旦知道了实际的校验和，请检查它是否在[https://gradle.org/release-checksums/](https://gradle.org/release-checksums/)上列出。如果已列出，则您已验证包装JAR的完整性。如果生成Wrapper JAR的Gradle版本与中的版本不匹配`gradle/wrapper/gradle-wrapper.properties`，则可以安全地`wrapper`再次运行任务以更新Wrapper JAR。

如果页面上未列出校验和，则包装JAR可能来自里程碑，候选发布版本或每晚构建，或者可能是由Gradle 3.3到4.0.2生成的。您应该尝试找出它是如何生成的，但是除非有其他证明，否则应将其视为不可信的。如果您认为Wrapper JAR受到威胁，请发送电子邮件至[security\@gradle.com](mailto:security@gradle.com)告知Gradle团队。