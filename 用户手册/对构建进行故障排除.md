 无标题 <style id="wiz_custom_css">html, .wiz-editor-body {font-size: 12pt;}.wiz-editor-body {font-family: Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;line-height: 1.7;margin: 0 auto;position:relative;padding: 20px 16px;}.wiz-editor-body h1,.wiz-editor-body h2,.wiz-editor-body h3,.wiz-editor-body h4,.wiz-editor-body h5,.wiz-editor-body h6 {margin:20px 0 10px;margin:1.25rem 0 0.625rem;padding: 0;font-weight: bold;}.wiz-editor-body h1 {font-size:20pt;font-size:1.67rem;}.wiz-editor-body h2 {font-size:18pt;font-size:1.5rem;}.wiz-editor-body h3 {font-size:15pt;font-size:1.25rem;}.wiz-editor-body h4 {font-size:14pt;font-size:1.17rem;}.wiz-editor-body h5 {font-size:12pt;font-size:1rem;}.wiz-editor-body h6 {font-size:12pt;font-size:1rem;color: #777777;margin: 1rem 0;}.wiz-editor-body div,.wiz-editor-body p,.wiz-editor-body ul,.wiz-editor-body ol,.wiz-editor-body dl,.wiz-editor-body li {margin:8px 0 0;}.wiz-editor-body blockquote,.wiz-editor-body table,.wiz-editor-body pre,.wiz-editor-body code {margin:8px 0;}.wiz-editor-body .CodeMirror pre {margin:0;}.wiz-editor-body a {word-wrap: break-word;text-decoration-skip-ink: none;}.wiz-editor-body ul,.wiz-editor-body ol {padding-left:32px;padding-left:2rem;}.wiz-editor-body ol.wiz-list-level1 > li {list-style-type:decimal;}.wiz-editor-body ol.wiz-list-level2 > li {list-style-type:lower-latin;}.wiz-editor-body ol.wiz-list-level3 > li {list-style-type:lower-roman;}.wiz-editor-body li.wiz-list-align-style {list-style-position: inside; margin-left: -1em;}.wiz-editor-body blockquote {padding: 0 12px;}.wiz-editor-body blockquote > :first-child {margin-top:0;}.wiz-editor-body blockquote > :last-child {margin-bottom:0;}.wiz-editor-body img {border:0;max-width:100%;height:auto !important;margin:2px 0;padding: 2px;vertical-align:bottom;}.wiz-editor-body table {border-collapse:collapse;border:1px solid #a7afbc;}.wiz-editor-body td,.wiz-editor-body th {padding:4px 8px;border-collapse:collapse;border:1px solid #a7afbc;min-height:28px;word-break:break-word;box-sizing: border-box;}.wiz-editor-body td > div:first-child {margin-top:0;}.wiz-editor-body td > div:last-child {margin-bottom:0;}.wiz-editor-body img.wiz-svg-image {box-shadow:1px 1px 4px #E8E8E8;}.wiz-editor-body .wiz-image-container {margin:0;max-width: 100%;display: inline-flex;flex-direction: column;}.wiz-editor-body .wiz-image-container .wiz-image-title {display:inline-block;text-align: center;color: #a7afbc;line-height: 18px;font-size: 12px;min-height: 18px;width: 100%;white-space: normal;}.wiz-hide {display:none !important;}.wiz-editor-body.wiz-editor-outline {padding-right:0; padding-left:0;}.wiz-editor-body.wiz-editor-outline .outline-container {margin:0; padding:0; line-height:1.5;}.wiz-editor-body.wiz-editor-outline .outline-container div {margin:0;}.wiz-editor-body.wiz-editor-outline .node {margin:0; padding: 0;}.wiz-editor-body.wiz-editor-outline .outline-container > .node {margin-right:24px; margin-left:30px;}.wiz-editor-body.wiz-editor-outline .node.collapsed .children {display:none;}.wiz-editor-body.wiz-editor-outline .node .row {position:relative; padding-left:26px;}.wiz-editor-body.wiz-editor-outline .node .operator-container {width:36px;position:absolute; top:4px; left:-18px;}.wiz-editor-body.wiz-editor-outline .node .operator-bar {position:absolute; top:0; left:0; right:0; bottom:0; display:flex; align-items:center; justify-content:center;}.wiz-editor-body.wiz-editor-outline .node .switch {width:18px; height:18px;display:flex;flex-direction: column;align-items: center;overflow: hidden;}.wiz-editor-body.wiz-editor-outline .node .switch i {font-size:20px;position:relative;left:-1px;top:-1px;}.wiz-editor-body.wiz-editor-outline .node .switch.active {cursor:pointer;color:transparent; transition:transform 200ms ease 0s;}.wiz-editor-body.wiz-editor-outline .node.collapsed .switch.active {transform:rotateZ(-90deg);}.wiz-editor-body.wiz-editor-outline .node .row:hover .switch.active {color:#505F79}.wiz-editor-body.wiz-editor-outline .node .dot {display:flex; align-items:center; justify-content:center; border-radius:100%; width:18px; height:18px;}.wiz-editor-body.wiz-editor-outline .node.collapsed .dot {background-color:rgba(80, 95, 121, .15);}.wiz-editor-body.wiz-editor-outline .node .dot-icon {background-color:#505F79; border-radius:100%; width:6px; height:6px;}.wiz-editor-body.wiz-editor-outline .node .child {margin-left:8px; border-left:1px solid #E6E9ED; padding-left:17px;}.wiz-editor-body.wiz-editor-outline .node .content {flex:1;outline:none; padding:4px 0;}.wiz-editor-body.wiz-editor-outline .node div.content {font-size:1rem;}.wiz-editor-body.wiz-editor-outline .node.complete > .row .content {text-decoration:line-through;color:#A7AFBC;}.wiz-editor-body.wiz-editor-outline .node .notes {outline:none; font-size:.8rem; color:#A7AFBC;}.wiz-editor-body.wiz-editor-outline .node .image {outline:none; padding-top:4px; padding-bottom:4px;}.wiz-editor-body.wiz-editor-outline .outline-container h1,.wiz-editor-body.wiz-editor-outline .outline-container h2,.wiz-editor-body.wiz-editor-outline .outline-container h3,.wiz-editor-body.wiz-editor-outline .outline-container h4,.wiz-editor-body.wiz-editor-outline .outline-container h5,.wiz-editor-body.wiz-editor-outline .outline-container h6 {margin:0;}body, .wiz-editor-body { padding-left: 48px; padding-right: 48px;}</style>

# 对构建进行故障排除

内容

* [对Gradle安装进行故障排除](#sec:troubleshooting_installation)
* [调试依赖项解析](#sec:troubleshooting_dependency_resolution)
* [对缓慢的Gradle构建进行故障排除](#sec:troubleshooting_performance)
* [调试构建逻辑](#sec:troubleshooting_build_logic)
* [调试IDE集成](#sec:troubleshooting_ide_integration)
* [获得更多帮助](#getting_additional_help)

以下是常见问题的集合以及解决这些问题的建议。您可以获取其他技巧，并搜索[Gradle论坛](https://discuss.gradle.org/c/help-discuss)和[StackOverflow #gradle](https://stackoverflow.com/questions/tagged/gradle)答案以及来自[help.gradle.org的](https://help.gradle.org/)Gradle文档。

## [](#sec:troubleshooting_installation)[对Gradle安装进行故障排除](#sec:troubleshooting_installation)

如果您按照[安装说明进行操作]()，并且无法执行Gradle构建，则以下一些技巧可能会有所帮助。

如果仅在调用[Gradle Wrapper]()之外安装了[Gradle]()，则可以通过`gradle \--version`在终端中运行来检查Gradle的安装。

您应该会看到以下内容：

❯gradle-版本
 -------------------------------------------------- ---------- 摇篮6.5 -------------------------------------------------- ----------
 建立时间：2020-06-02 20:46:21 UTC 修订：a27f41e4ae5e8a41ab9b19f8dd6d86d7b384dad4
 科特林：1.3.72 Groovy：2.5.11 Ant：于2019年9月1日编译的Apache Ant（TM）版本1.10.7 JVM：14（采用OpenJDK 14 + 36） 作业系统：Mac OS X 10.15.2 x86\_64

如果没有，您可能会看到一些东西。

### [](#command_not_found_gradle)[找不到命令：gradle](#command_not_found_gradle)

如果收到“找不到命令：gradle”，则需要确保Gradle已正确添加到您的中`PATH`。

### [](#java_home_is_set_to_an_invalid_directory)[JAVA\_HOME设置为无效目录](#java_home_is_set_to_an_invalid_directory)

如果您得到以下信息：

错误：JAVA\_HOME设置为无效目录
 请在您的环境中设置JAVA\_HOME变量以匹配Java安装的位置。

您需要确保[正确安装](https://www.java.com/en/download/help/index_installing.xml)了[Java Development Kit](https://jdk.java.net/)版本8或更高版本，设置了环境变量，并将[Java添加到了您的中](https://www.java.com/en/download/help/path.xml)。[](https://www.java.com/en/download/help/index_installing.xml)`JAVA_HOME`[`PATH`](https://www.java.com/en/download/help/path.xml)

### [](#permission_denied)[没有权限](#permission_denied)

如果您获得“权限被拒绝”，则意味着Gradle可能存在于正确的位置，但不可执行。您可以`chmod +x path/to/executable`在基于\* nix的系统上解决此问题。

### [](#other_installation_failures)[其他安装失败](#other_installation_failures)

如果`gradle \--version`可行，但您的所有构建都失败并出现相同的错误，则您的Gradle构建配置脚本之一可能存在问题。

您可以通过运行`gradle help`配置脚本而不执行Gradle任务来验证问题是否出在Gradle脚本上。如果错误仍然存在，则构建配置存在问题。如果不是，则问题在于执行一个或多个请求的任务（Gradle首先执行配置脚本，然后执行构建步骤）。

## [](#sec:troubleshooting_dependency_resolution)[调试依赖项解析](#sec:troubleshooting_dependency_resolution)

[疑难解答依赖性解析]()中介绍了常见的依赖性解析问题，例如解决版本冲突。

通过单击“_依赖关系”_视图并使用搜索功能，并指定解决原因，您可以看到依赖关系树，并查看哪些已解决的依赖关系版本与请求的版本不同。

图1.调试依赖项与构建扫描冲突

可以使用带有筛选条件的[实际构建扫描](https://scans.gradle.com/s/sample/troubleshooting-userguide/dependencies?expandAll&filters=WzFd&toggled=W1swXSxbMF0sWzAsMF0sWzAsMV1d)进行探索。

## [](#sec:troubleshooting_performance)[对缓慢的Gradle构建进行故障排除](#sec:troubleshooting_performance)

有关构建性能问题（包括“同步速度慢”），请参阅《[改进Gradle构建的性能](https://guides.gradle.org/performance/)指南》。

Android开发人员应观看Android SDK工具团队的有关[加速Android Gradle构建](https://youtu.be/7ll-rkLCtyk)的演示。Android Studio用户指南还介绍了许多[有关优化构建速度的](https://developer.android.com/studio/build/optimize-your-build.html)技巧。

## [](#sec:troubleshooting_build_logic)[调试构建逻辑](#sec:troubleshooting_build_logic)

### [](#attaching_a_debugger_to_your_build)[将调试器附加到构建](#attaching_a_debugger_to_your_build)

您可以通过将属性设置为“ true”，然后将远程调试器附加到端口5005来设置断点并在Gradle构建自身中调试[buildSrc和独立插件]()`org.gradle.debug`。

❯gradle帮助-Dorg.gradle.debug = true

另外，如果您采用了Kotlin DSL，则还可以自己调试构建脚本。

以下视频演示了如何使用IntelliJ IDEA调试示例构建。

图2.构建脚本的交互式调试

### [](#adding_and_changing_logging)[添加和更改日志记录](#adding_and_changing_logging)

除了[控制日志记录的详细程度外]()，您还可以使用[`--console=verbose`flag控制]()生命周期日志记录中任务结果的显示（例如“ UP-TO-DATE”）。

您还可以通过注册各种事件侦听器，用自己的Gradle日志记录代替许多日志记录。[日志记录文档中说明]()了一个[自定义事件记录器的]()示例。您还可以[从外部工具控制日志记录]()，使它们更加冗长，以便调试它们的执行。

<table style="background:none;width:912px;"><tbody><tr><td class="icon" style="color:rgba(0, 0, 0, 0.8);width:80px;"><i class="fa icon-note"></i></td><td class="content" style="font-size:1.0625rem;color:rgba(0, 0, 0, 0.6);"><font><font>您</font><font>可以在下面找到</font><font>来自</font></font><a href="" style="color:rgb(29, 162, 189);text-decoration:none;"><font><font>Gradle守护程序的</font></font></a><font><font>其他日志</font></font><code style="font-family:Inconsolata, monospace;font-size:0.9375rem;color:rgba(0, 0, 0, 0.9);background-color:rgb(247, 247, 248);">GRADLE_USER_HOME/daemon/&lt;gradle-version&gt;/</code><font><font>。</font></font></td></tr></tbody></table>

### [](#task_executed_when_it_should_have_been_up_to_date)[任务应该在UP-TO-DATE执行](#task_executed_when_it_should_have_been_up_to_date)

`--info`日志解释了执行任务的原因，尽管构建扫描通过以下方式以可搜索的可视方式执行此操作：转到“_时间轴”_视图，然后单击要检查的任务。

图3.使用构建扫描调试增量构建

您可以从此[清单中]()了解任务结果的含义。

## [](#sec:troubleshooting_ide_integration)[调试IDE集成](#sec:troubleshooting_ide_integration)

可以通过“刷新” Gradle解决IDE中许多不常见的错误。另请参阅有关[在IntelliJ IDEA](https://www.jetbrains.com/help/idea/gradle.html)和[Eclipse中](http://www.vogella.com/tutorials/EclipseGradle/article.html)使用Gradle的更多文档。

### [](#refreshing_intellij_idea)[刷新IntelliJ IDEA](#refreshing_intellij_idea)

**注意：**这仅适用于[链接到IntelliJ的](https://www.jetbrains.com/help/idea/gradle.html#link_gradle_project)Gradle项目。

在主菜单中，进入`View`\>`Tool Windows`\>`Gradle`。然后单击_刷新_图标。

图4.在IntelliJ IDEA中刷新Gradle项目

### [](#refreshing_eclipse_using_buildship)[刷新Eclipse（使用Buildship）](#refreshing_eclipse_using_buildship)

如果您将[Buildship](https://projects.eclipse.org/projects/tools.buildship)用于Eclipse IDE，则可以通过打开“ Gradle Tasks”视图并单击“ Refresh”图标，或者通过在编辑Gradle脚本时从上下文菜单执行`Gradle`\>`Refresh Gradle Project`命令来重新同步Gradle构建。。

图5.在Eclipse Buildship中刷新Gradle项目

## [](#getting_additional_help)[获得更多帮助](#getting_additional_help)

如果您在这里没有找到解决问题的方法，请在[帮助论坛](https://discuss.gradle.org/c/help-discuss)上与Gradle社区联系，或者使用[help.gradle.org](https://help.gradle.org/)搜索相关的开发人员资源。

如果您认为自己在Gradle中发现了错误，请在GitHub上[提交问题](https://github.com/gradle/gradle/issues)。