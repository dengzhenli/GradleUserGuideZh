 无标题 <style id="wiz_custom_css">html, .wiz-editor-body {font-size: 12pt;}.wiz-editor-body {font-family: Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;line-height: 1.7;margin: 0 auto;position:relative;padding: 20px 16px;}.wiz-editor-body h1,.wiz-editor-body h2,.wiz-editor-body h3,.wiz-editor-body h4,.wiz-editor-body h5,.wiz-editor-body h6 {margin:20px 0 10px;margin:1.25rem 0 0.625rem;padding: 0;font-weight: bold;}.wiz-editor-body h1 {font-size:20pt;font-size:1.67rem;}.wiz-editor-body h2 {font-size:18pt;font-size:1.5rem;}.wiz-editor-body h3 {font-size:15pt;font-size:1.25rem;}.wiz-editor-body h4 {font-size:14pt;font-size:1.17rem;}.wiz-editor-body h5 {font-size:12pt;font-size:1rem;}.wiz-editor-body h6 {font-size:12pt;font-size:1rem;color: #777777;margin: 1rem 0;}.wiz-editor-body div,.wiz-editor-body p,.wiz-editor-body ul,.wiz-editor-body ol,.wiz-editor-body dl,.wiz-editor-body li {margin:8px 0 0;}.wiz-editor-body blockquote,.wiz-editor-body table,.wiz-editor-body pre,.wiz-editor-body code {margin:8px 0;}.wiz-editor-body .CodeMirror pre {margin:0;}.wiz-editor-body a {word-wrap: break-word;text-decoration-skip-ink: none;}.wiz-editor-body ul,.wiz-editor-body ol {padding-left:32px;padding-left:2rem;}.wiz-editor-body ol.wiz-list-level1 > li {list-style-type:decimal;}.wiz-editor-body ol.wiz-list-level2 > li {list-style-type:lower-latin;}.wiz-editor-body ol.wiz-list-level3 > li {list-style-type:lower-roman;}.wiz-editor-body li.wiz-list-align-style {list-style-position: inside; margin-left: -1em;}.wiz-editor-body blockquote {padding: 0 12px;}.wiz-editor-body blockquote > :first-child {margin-top:0;}.wiz-editor-body blockquote > :last-child {margin-bottom:0;}.wiz-editor-body img {border:0;max-width:100%;height:auto !important;margin:2px 0;padding: 2px;vertical-align:bottom;}.wiz-editor-body table {border-collapse:collapse;border:1px solid #a7afbc;}.wiz-editor-body td,.wiz-editor-body th {padding:4px 8px;border-collapse:collapse;border:1px solid #a7afbc;min-height:28px;word-break:break-word;box-sizing: border-box;}.wiz-editor-body td > div:first-child {margin-top:0;}.wiz-editor-body td > div:last-child {margin-bottom:0;}.wiz-editor-body img.wiz-svg-image {box-shadow:1px 1px 4px #E8E8E8;}.wiz-editor-body .wiz-image-container {margin:0;max-width: 100%;display: inline-flex;flex-direction: column;}.wiz-editor-body .wiz-image-container .wiz-image-title {display:inline-block;text-align: center;color: #a7afbc;line-height: 18px;font-size: 12px;min-height: 18px;width: 100%;white-space: normal;}.wiz-hide {display:none !important;}.wiz-editor-body.wiz-editor-outline {padding-right:0; padding-left:0;}.wiz-editor-body.wiz-editor-outline .outline-container {margin:0; padding:0; line-height:1.5;}.wiz-editor-body.wiz-editor-outline .outline-container div {margin:0;}.wiz-editor-body.wiz-editor-outline .node {margin:0; padding: 0;}.wiz-editor-body.wiz-editor-outline .outline-container > .node {margin-right:24px; margin-left:30px;}.wiz-editor-body.wiz-editor-outline .node.collapsed .children {display:none;}.wiz-editor-body.wiz-editor-outline .node .row {position:relative; padding-left:26px;}.wiz-editor-body.wiz-editor-outline .node .operator-container {width:36px;position:absolute; top:4px; left:-18px;}.wiz-editor-body.wiz-editor-outline .node .operator-bar {position:absolute; top:0; left:0; right:0; bottom:0; display:flex; align-items:center; justify-content:center;}.wiz-editor-body.wiz-editor-outline .node .switch {width:18px; height:18px;display:flex;flex-direction: column;align-items: center;overflow: hidden;}.wiz-editor-body.wiz-editor-outline .node .switch i {font-size:20px;position:relative;left:-1px;top:-1px;}.wiz-editor-body.wiz-editor-outline .node .switch.active {cursor:pointer;color:transparent; transition:transform 200ms ease 0s;}.wiz-editor-body.wiz-editor-outline .node.collapsed .switch.active {transform:rotateZ(-90deg);}.wiz-editor-body.wiz-editor-outline .node .row:hover .switch.active {color:#505F79}.wiz-editor-body.wiz-editor-outline .node .dot {display:flex; align-items:center; justify-content:center; border-radius:100%; width:18px; height:18px;}.wiz-editor-body.wiz-editor-outline .node.collapsed .dot {background-color:rgba(80, 95, 121, .15);}.wiz-editor-body.wiz-editor-outline .node .dot-icon {background-color:#505F79; border-radius:100%; width:6px; height:6px;}.wiz-editor-body.wiz-editor-outline .node .child {margin-left:8px; border-left:1px solid #E6E9ED; padding-left:17px;}.wiz-editor-body.wiz-editor-outline .node .content {flex:1;outline:none; padding:4px 0;}.wiz-editor-body.wiz-editor-outline .node div.content {font-size:1rem;}.wiz-editor-body.wiz-editor-outline .node.complete > .row .content {text-decoration:line-through;color:#A7AFBC;}.wiz-editor-body.wiz-editor-outline .node .notes {outline:none; font-size:.8rem; color:#A7AFBC;}.wiz-editor-body.wiz-editor-outline .node .image {outline:none; padding-top:4px; padding-bottom:4px;}.wiz-editor-body.wiz-editor-outline .outline-container h1,.wiz-editor-body.wiz-editor-outline .outline-container h2,.wiz-editor-body.wiz-editor-outline .outline-container h3,.wiz-editor-body.wiz-editor-outline .outline-container h4,.wiz-editor-body.wiz-editor-outline .outline-container h5,.wiz-editor-body.wiz-editor-outline .outline-container h6 {margin:0;}body, .wiz-editor-body { padding-left: 48px; padding-right: 48px;}</style>

# 在子项目之间共享构建逻辑

内容

* [公约插件](#sec:convention_plugins)
* [跨项目配置](#sec:convention_plugins_vs_cross_configuration)

## [](#sec:convention_plugins)[公约插件](#sec:convention_plugins)

通常，多项目构建中的子项目具有一些共同的特征。例如，几个子项目可能包含特定编程语言的_代码_，而另一个子项目可能专用于_文档_。代码质量规则适用于所有_代码_子项目，但不适用于_文档_子项目。同时，具有一个共同特征的子项目可能有不同的用途-它们可能会产生不同的_工件类型_，从而进一步区分它们，例如：

* _公共图书馆_\-发布到某个存储库的图书馆
* _内部库_\-其他子项目在项目内部内部依赖的库
* _命令行应用程序_\-具有特定包装要求的应用程序
* _Web服务_\-具有与上述不同的特定包装要求的应用程序
* 等等

其他一些_代码_子项目可能专用于_测试目的_等等。

上面的特征标识子项目的_类型_。换句话说，子项目的_类型_告诉我们项目具有什么特征。

Gradle建议的组织构建逻辑的方法是使用其插件系统。插件应定义子项目的_类型_。实际上，[Gradle核心插件]()以相同的方式建模-例如，[Java插件]()配置通用`java`项目，而[Java库插件在]()内部应用[Java插件]()并配置特定于Java库的方面。同样，[应用程序插件]()应用并配置[Java插件]()和[分发插件]()。

您可以通过应用和配置核心和外部插件来组成定制构建逻辑，并创建定义新项目_类型_和配置特定于您的项目或组织的约定的定制插件。对于本节开头的每个示例特征，我们可以编写一个插件，该插件封装给定_类型_的子项目所共有的逻辑。

我们建议将约定插件的源代码和测试放在`buildSrc`项目根目录下的特殊目录中。有关更多信息`buildSrc`，请参阅[使用buildSrc来组织构建逻辑]()。

看一下[演示多项目构建]()的[示例，]()该[示例使用约定插件对构建逻辑进行建模]()。

使用约定插件组成构建逻辑的多项目构建的另一个更复杂和真实的示例是[Gradle Build Tool](https://github.com/gradle/gradle)本身的[构建](https://github.com/gradle/gradle)。

## [](#sec:convention_plugins_vs_cross_configuration)[跨项目配置](#sec:convention_plugins_vs_cross_configuration)

在子项目之间共享构建逻辑的另一种不鼓励使用的方法是通过和DSL构造进行_跨项目配置_。通过交叉配置，可以将构建逻辑注入到子项目中，并且在查看子项目的构建脚本时这并不明显，这使得更难理解特定子项目的逻辑。从长远来看，交叉配置通常会随着越来越多的条件逻辑和更高的维护负担而变得复杂。交叉配置还会[在项目之间]()引入[配置时耦合]()，这会阻止[按需配置等]()优化工作正常进行。`subprojects {}``allprojects {}`

交叉配置有两种最常见的用法，可以使用约定插件更好地建模：

* 将插件或其他配置应用于某些类型的子项目。通常，交叉配置部分会这样做`if subproject is of type X, then configure Y`。这等效于将`X-conventions`插件直接应用于子项目。
* 从特定类型的子项目中提取信息。可以使用[传出配置变量对]()这种用例进行建模。